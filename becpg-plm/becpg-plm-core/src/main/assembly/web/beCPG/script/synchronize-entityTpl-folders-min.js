var entityTpls=search.luceneSearch('+ASPECT:"bcpg:entityTplAspect" +ASPECT:"bcpg:productAspect"');foreach(var entityTpl in entityTpls){var sourceNodes=entityTpl.sourceAssocs["bcpg:entityTplRef"];if(sourceNodes!==null){for(var k=0;k<sourceNodes.length;k++){if(sourceNodes[k].hasAspect("bcpg:entityTplAspect")==false){logger.log(sourceNodes[k].name+" - "+sourceNodes[k].properties["bcpg:code"]);foreach(var folder in sourceNodes[k].children){if(folder.name!="DataLists"&&folder.children.length==0){logger.log("remove "+folder.name+folder.children.length);folder.remove()}}foreach(var folderTpl in entityTpl.children){if(folderTpl.name!="DataLists"&&sourceNodes[k].childByNamePath(folderTpl.name)==null){logger.log("copy folder tpl "+folderTpl.name);folderTpl.copy(sourceNodes[k],true)}}}}}};