(function(){if(beCPG.component.EntityDataListToolbar){YAHOO.Bubbling.fire("registerToolbarButtonAction",{actionName:"toggle-gantt",right:true,evaluate:function(b,a){return b.name!==null&&(b.name.indexOf("View-gantt")>-1||b.name==="taskList")},createWidget:function(d,a){var c=document.createElement("div");d.appendChild(c);Dom.addClass(c,"ganttCkeckbox");var b=new YAHOO.widget.Button({type:"checkbox",title:a.msg("button.toggle-gantt.description"),container:c,checked:true});b.on("checkedChange",function(){YAHOO.Bubbling.fire("viewModeChange")});return b}});YAHOO.Bubbling.fire("registerToolbarButtonAction",{actionName:"full-screen",evaluate:function(b,a){return b.name!==null&&(b.name.indexOf("View-gantt")>-1||b.name==="taskList")},fn:function(a){if(Dom.hasClass("alf-hd","hidden")){Dom.removeClass("alf-hd","hidden");Dom.removeClass("alf-filters","hidden");Dom.removeClass("alf-ft","hidden");Dom.removeClass("Share","full-screen");Dom.addClass("alf-content","yui-b");Dom.setStyle("alf-content","margin-left","200px")}else{Dom.addClass("alf-hd","hidden");Dom.addClass("alf-ft","hidden");Dom.addClass("Share","full-screen");Dom.addClass("alf-ft","hidden");Dom.addClass("alf-filters","hidden");Dom.removeClass("alf-content","yui-b");Dom.setStyle("alf-content","margin-left",null)}}});YAHOO.Bubbling.fire("registerToolbarButtonAction",{actionName:"print",evaluate:function(b,a){return b.name!==null&&(b.name.indexOf("View-gantt")>-1||b.name==="taskList")},fn:function(a){var d=document.getElementsByTagName("style");for(var c in d){var b=d[c];b.media="all"}Dom.addClass("alf-hd","hidden");Dom.addClass("alf-ft","hidden");Dom.addClass("Share","full-screen");Dom.addClass("alf-ft","hidden");Dom.addClass("alf-filters","hidden");Dom.addClass(this.id,"hidden");Dom.removeClass("alf-content","yui-b");Dom.setStyle("alf-content","margin-left",null);print();Dom.removeClass("alf-hd","hidden");Dom.removeClass("alf-ft","hidden");Dom.removeClass("Share","full-screen");Dom.removeClass("alf-ft","hidden");Dom.removeClass("alf-filters","hidden");Dom.removeClass(this.id,"hidden");Dom.addClass("alf-content","yui-b");Dom.setStyle("alf-content","margin-left","200px")}});YAHOO.Bubbling.fire("registerToolbarButtonAction",{actionName:"sub-project",right:false,evaluate:function(b,a){return b.name!=null&&(b.name==="taskList")&&a!=null&&a.userAccess.edit},fn:function(d){var a=this;var c=YAHOO.lang.substitute(Alfresco.constants.URL_SERVICECONTEXT+"components/form?formId=formulation&itemKind=type&itemId={itemId}&destination={destination}&mode=create&submitType=json&showCancelButton=true&popup=true",{itemId:"pjt:project",destination:a.entity.parentNodeRef});var b=new Alfresco.module.SimpleDialog(a.id+"-createSubProject");b.setOptions({width:"34em",templateUrl:c,actionUrl:null,destroyOnHide:true,doBeforeDialogShow:{fn:function(e,f){Alfresco.util.populateHTML([f.id+"-dialogTitle",a.msg("action.sub-project.create.title")])},scope:this},doBeforeFormSubmit:{fn:function(e){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.sub-project.create.please-wait")})},scope:this},onSuccess:{fn:function(e){if(e.json){Alfresco.util.Ajax.jsonRequest({method:Alfresco.util.Ajax.POST,url:Alfresco.constants.PROXY_URI+"api/type/pjt:taskList/formprocessor",dataObj:{alf_destination:(a.datalistMeta.nodeRef!=null?a.datalistMeta.nodeRef:a.options.parentNodeRef),assoc_pjt_subProjectRef_added:e.json.persistedObject,prop_pjt_tlTaskName:"Sub project"},successCallback:{fn:function(f){if(f.json){YAHOO.Bubbling.fire("dataItemCreated",{nodeRef:f.json.persistedObject,callback:function(g){Alfresco.util.PopupManager.displayMessage({text:a.msg("message.sub-project.create.success")})}})}},scope:this}})}},scope:this}}).show()}});YAHOO.Bubbling.fire("registerToolbarButtonAction",{actionName:"formulate",hideLabel:true,evaluate:function(b,a){return b.name!=null&&(b.name==="taskList")&&a!=null&&a.userAccess.edit},fn:function(a){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.formulate.please-wait")});var b=YAHOO.util.Selector.query("div.formulate");Dom.addClass(b,"loading");Alfresco.util.Ajax.request({method:Alfresco.util.Ajax.GET,responseContentType:Alfresco.util.Ajax.JSON,url:Alfresco.constants.PROXY_URI+"becpg/project/formulate/node/"+this.options.entityNodeRef.replace(":/",""),successCallback:{fn:function(c){Alfresco.util.PopupManager.displayMessage({text:this.msg("message.formulate.success")});YAHOO.Bubbling.fire("refreshDataGrids");Dom.removeClass(b,"loading")},scope:this},failureCallback:{fn:function(c){if(c.json&&c.json.message){Alfresco.util.PopupManager.displayPrompt({title:this.msg("message.formulate.failure"),text:c.json.message})}else{Alfresco.util.PopupManager.displayMessage({text:this.msg("message.formulate.failure")})}Dom.removeClass(b,"loading")},scope:this}})}})}})();