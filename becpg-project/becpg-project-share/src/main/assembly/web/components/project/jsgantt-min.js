var JSGantt;if(!JSGantt){JSGantt={}}JSGantt.PREF_GANTT_FORMAT="fr.becpg.gantt.format";(function(){JSGantt.register=function(b){JSGantt.scope=b;JSGantt.msg=function(c){return Alfresco.util.message.call(b,c,b.name,Array.prototype.slice.call(arguments).slice(1))}};JSGantt.TaskItem=function(v,x,f,d,k,t,w,r,o,M,c,D,j,u,z,C){var H=v;var K=x;var l=JSGantt.parseDateStr(f,g.getDateInputFormat());var y=JSGantt.parseDateStr(d,g.getDateInputFormat());var m=k;var I=z;var E=t;var J=w;var F=r;var A=o;var h=M;var b=c;var e=D;var i=j;var L=u;var G=1;var p=0;var B=1;var n=C;var s=0,O=0,q=0,N=0;this.getID=function(){return H};this.getName=function(){return K};this.getStart=function(){return l};this.getEnd=function(){return J?l:y};this.getColor=function(){return m};this.getLineColor=function(){return I};this.getLink=function(){return E};this.getMile=function(){return J};this.getDepend=function(){if(i){return i}return null};this.getCaption=function(){if(L){return L}return""};this.getResource=function(){if(typeof(F)!=="undefined"&&F!==null){return F}return"&nbsp;"};this.getCompVal=function(){if(A){return A}return 0};this.getCompStr=function(){if(A){return A+"%"}return""};this.getDuration=function(R){var Q=null,P=null;if(J){P="-"}else{if(R==="hour"){Q=Math.ceil((this.getEnd()-this.getStart())/(60*60*1000));if(Q===1){P="1 "+JSGantt.msg("jsgantt.hour")}else{P=Q+" "+JSGantt.msg("jsgantt.hours")}}else{if(R==="minute"){Q=Math.ceil((this.getEnd()-this.getStart())/(60*1000));if(Q===1){P="1 "+JSGantt.msg("jsgantt.minute")}else{P=Q+" "+JSGantt.msg("jsgantt.minutes")}}else{Q=Math.ceil((this.getEnd()-this.getStart())/(24*60*60*1000)+1);if(Q===1){P="1 "+JSGantt.msg("jsgantt.day")}else{P=Q+" "+JSGantt.msg("jsgantt.days")}}}}return P};this.getParent=function(){return b};this.getGroup=function(){return h};this.getSubProject=function(){return n};this.getOpen=function(){return e};this.getLevel=function(){return G};this.getNumKids=function(){return p};this.getStartX=function(){return s};this.getStartY=function(){return O};this.getEndX=function(){return q};this.getEndY=function(){return N};this.getVisible=function(){return B};this.setDepend=function(P){i=P};this.setStart=function(P){l=P};this.setEnd=function(P){y=P};this.setLevel=function(P){G=P};this.setNumKid=function(P){p=P};this.setCompVal=function(P){A=P};this.setStartX=function(P){s=P};this.setStartY=function(P){O=P};this.setEndX=function(P){q=P};this.setEndY=function(P){N=P};this.setOpen=function(P){e=P};this.setVisible=function(P){B=P}};JSGantt.GanttChart=function(q,l,h){var m=new Alfresco.service.Preferences();var z=q;var e=l;var b="day";if(h!=null&&h.length>0){b=h}else{b=Alfresco.util.findValueByDotNotation(m.get(),JSGantt.PREF_GANTT_FORMAT);if(!b){b="day"}}var u=0;var n=1;var t=0;var o=0;var r=0;var w=1;var k=1;var s="mm/dd/yyyy";var i="mm/dd/yy";var j=0;var p="";var d=1;var c=[];var v=["day","week","month","quarter"];var f=[1,1,1,2,2,2,3,3,3,4,4,4];var x=[31,28,31,30,31,30,31,31,30,31,30,31];var y=Alfresco.util.message("months.long").split(",");this.setFormatArr=function(){v=new Array();for(var A=0;A<arguments.length;A++){v[A]=arguments[A]}if(v.length>4){v.length=4}};this.setShowRes=function(A){u=A};this.setShowDur=function(A){n=A};this.setShowSelect=function(A){w=A};this.setColWidthFactor=function(A){k=A};this.setShowComp=function(A){t=A};this.setShowStartDate=function(A){o=A};this.setShowEndDate=function(A){r=A};this.setDateInputFormat=function(A){s=A};this.setDateDisplayFormat=function(A){i=A};this.setCaptionType=function(A){p=A};this.setFormat=function(A){b=A;m.set(JSGantt.PREF_GANTT_FORMAT,A);this.Draw()};this.getFormat=function(){return b};this.getShowRes=function(){return u};this.getShowDur=function(){return n};this.getShowComp=function(){return t};this.getShowStartDate=function(){return o};this.getShowEndDate=function(){return r};this.getDateInputFormat=function(){return s};this.getDateDisplayFormat=function(){return i};this.getCaptionType=function(){return p};this.CalcTaskXY=function(){var B=this.getList();for(var A=0;A<B.length;A++){vcurrDivID=B[A].getID();vTaskDiv=document.getElementById("taskbar_"+vcurrDivID);vBarDiv=document.getElementById("bardiv_"+vcurrDivID);vParDiv=document.getElementById("childgrid_"+vcurrDivID);if(vBarDiv){B[A].setStartX(vBarDiv.offsetLeft);B[A].setStartY(vParDiv.offsetTop+vBarDiv.offsetTop+6);B[A].setEndX(vBarDiv.offsetLeft+vBarDiv.offsetWidth);B[A].setEndY(vParDiv.offsetTop+vBarDiv.offsetTop+6)}}};this.AddTaskItem=function(A){c.push(A)};this.getList=function(){return c};this.clearDependencies=function(){var D=document.getElementById("rightside");var C;var B=d;for(var A=1;A<B;A++){C=document.getElementById("line"+A);if(C){D.removeChild(C)}}d=1};this.scrollToY=function(E,D){var C=parseInt(YAHOO.util.Dom.getStyle(D,"width").replace("px",""),10);var F=YAHOO.util.Dom.get("leftside");var G=YAHOO.util.Dom.get("rightside");var A=(C-350);var B=new YAHOO.util.Resize("leftside",{handles:["r"],minWidth:350,maxWidth:A});B.on("resize",function(M){var I=M.width;var N=parseInt(YAHOO.util.Dom.getStyle(D,"width").replace("px",""),10);YAHOO.util.Dom.setStyle(F,"height","");YAHOO.util.Dom.setStyle(G,"width",(N-I-6)+"px");var J=YAHOO.util.Selector.query("td.ggTaskTitle span.task-title a.theme-color-1");if(J.length>0){var L=J[0].parentNode.parentNode.parentNode.parentNode;var H=YAHOO.util.Dom.getRegion(L);for(var K in J){YAHOO.util.Dom.setStyle(J[K],"max-width",(H.width-110)+"px")}}});if(E){G.scrollLeft=E}};this.sLine=function(C,E,A,D){vLeft=Math.min(C,A);vTop=Math.min(E,D);vWid=Math.abs(A-C)+1;vHgt=Math.abs(D-E)+1;vDoc=document.getElementById("rightside");var B=document.createElement("div");B.className="ggline";B.id="line"+d++;B.style.left=vLeft+"px";B.style.top=vTop+"px";B.style.width=vWid+"px";B.style.height=vHgt+"px";vDoc.appendChild(B)};this.dLine=function(B,G,A,F){var J=A-B;var I=F-G;var H=B;var E=G;var C=Math.max(Math.abs(J),Math.abs(I));J=J/C;I=I/C;for(var D=0;D<=C;D++){vx=Math.round(H);vy=Math.round(E);this.sLine(vx,vy,vx,vy);H+=J;E+=I}};this.drawDependency=function(C,E,B,D){var F=Dom.hasClass("Share","yui-skin-becpg");var A=F?16:12;if(C+A<B){this.sLine(C,E,C+4,E);this.sLine(C+4,E,C+4,D);this.sLine(C+4,D,B-1,D);this.dLine(B-2,D,B-5,D-4);this.dLine(B-2,D,B-5,D+4)}else{this.sLine(C,E,C+4,E);this.sLine(C+4,E,C+4,D-A);this.sLine(C+4,D-A,B-(A+4),D-A);this.sLine(B-(A+4),D-A,B-(A+4),D);this.sLine(B-(A+4),D,B-2,D);this.dLine(B-1,D,B-5,D-4);this.dLine(B-1,D,B-5,D+4)}};this.DrawDependencies=function(){this.CalcTaskXY();this.clearDependencies();var E=this.getList();for(var D=0;D<E.length;D++){vDepend=E[D].getDepend();if(vDepend){var A=vDepend+"";var G=A.split(",");var F=G.length;for(var B=0;B<F;B++){var C=this.getArrayLocationByID(G[B]);if(C!=null&&E[C].getVisible()==1&&E[D].getVisible()==1){if(E[C].getMile()){this.drawDependency(E[C].getEndX()-251,E[C].getEndY()+1,E[D].getStartX()-1,E[D].getStartY()+1)}else{this.drawDependency(E[C].getEndX()+1,E[C].getEndY()+1,E[D].getStartX()-1,E[D].getStartY()+1)}}}}}};this.getArrayLocationByID=function(B){var C=this.getList();for(var A=0;A<C.length;A++){if(C[A].getID()==B){return A}}return null};this.Draw=function(){try{var O=new Date();var ac=new Date();var E=new Date();var M=new Date();var F=new Date();var U=0;var P=0;var af=0;var J=0;var A="";var C="";var Z="";var R="";var I="";var H=0;var G=0;var aa=0;var B=0;var K=0;var Q="";var T=2;var ae=0;if(u===1){T++}if(n===1){T++}if(t===1){T++}if(o===1){T++}if(r===1){T++}if(c.length>0){JSGantt.processRows(c,0,-1,1,1);ac=JSGantt.getMinDate(c,b);O=JSGantt.getMaxDate(c,b);if(b=="day"){H=22*k;G=1}else{if(b=="week"){H=37*k;G=7}else{if(b=="month"){H=37*k;G=30}else{if(b=="quarter"){H=60*k;G=90}else{if(b=="hour"){H=22*k;G=1}else{if(b=="minute"){H=22*k;G=1}}}}}}B=(O.getTime()-ac.getTime())/(24*60*60*1000);j=B/G;aa=j*H+1;K=(H/G)+(1/G);A='<div class="yui-gd yui-dt">';C='<div class="yui-u first" id="leftside"><table cellSpacing="0" cellPadding="0" border="0"><colgroup>';C+='<col class="ggtaskCheckbox"/><col class="ggTaskTitle  ggCol'+T+'"></col>';if(u===1){C+='<col class="ggCol'+T+'"></col>'}if(n===1){C+='<col class="ggCol'+T+'"></col>'}if(t===1){C+='<col class="ggCol'+T+'"></col>'}if(o===1){C+='<col class="ggCol'+T+'"></col>'}if(r===1){C+='<col class="ggCol'+T+'"></col>'}C+='</colgroup><thead><tr class="gheader">';C+='<th  colspan="'+T+'">'+JSGantt.msg("jsgantt.format")+":&nbsp;";if(v.join().indexOf("minute")!=-1){if(b=="minute"){C+='<input type="radio" name="radFormat" value="minute" checked>'+JSGantt.msg("jsgantt.minute")}else{C+='<input type="radio" name="radFormat" onclick="JSGantt.changeFormat(\'minute\','+z+');" value="minute">'+JSGantt.msg("jsgantt.minute")}}if(v.join().indexOf("hour")!=-1){if(b=="hour"){C+='<input type="radio" name="radFormat" value="hour" checked>'+JSGantt.msg("jsgantt.hour")}else{C+='<input type="radio" name="radFormat" onclick="JSGantt.changeFormat(\'hour\','+z+');" value="hour">'+JSGantt.msg("jsgantt.hour")}}if(v.join().indexOf("day")!=-1){if(b=="day"){C+='<input type="radio" name="radFormat" value="day" checked>'+JSGantt.msg("jsgantt.day")}else{C+='<input type="radio" name="radFormat" onclick="JSGantt.changeFormat(\'day\','+z+');" value="day">'+JSGantt.msg("jsgantt.day")}}if(v.join().indexOf("week")!=-1){if(b=="week"){C+='<input type="radio" name="radFormat" value="week" checked>'+JSGantt.msg("jsgantt.week")}else{C+='<input type="radio" name="radFormat" onclick="JSGantt.changeFormat(\'week\','+z+');" value="week">'+JSGantt.msg("jsgantt.week")}}if(v.join().indexOf("month")!=-1){if(b=="month"){C+='<input type="radio" name="radFormat" value="month" checked>'+JSGantt.msg("jsgantt.month")}else{C+='<input type="radio" name="radFormat" onclick="JSGantt.changeFormat(\'month\','+z+');" value="month">'+JSGantt.msg("jsgantt.month")}}if(v.join().indexOf("quarter")!=-1){if(b=="quarter"){C+='<input type="radio" name="radFormat" value="quarter" checked>'+JSGantt.msg("jsgantt.quarter")}else{C+='<input type="radio" name="radFormat" onclick="JSGantt.changeFormat(\'quarter\','+z+');" value="quarter">'+JSGantt.msg("jsgantt.quarter")}}C+="</th></tr>";C+='<tr class="gheader"> <th colspan="2"><nobr></nobr></th>';if(u===1){C+='  <th class="nowrap" >'+JSGantt.msg("jsgantt.resource")+"</th>"}if(n===1){C+='  <th  class="nowrap" >'+JSGantt.msg("jsgantt.duration")+"</th>"}if(t===1){C+='  <th  class="nowrap" >'+JSGantt.msg("jsgantt.percomp")+"</th>"}if(o===1){C+='  <th class="nowrap" >'+JSGantt.msg("jsgantt.begin")+"</th>"}if(r===1){C+="  <th>"+JSGantt.msg("jsgantt.end")+"</th>"}C+='</tr></thead><tbody class="yui-dt-data">';for(var ab=0;ab<c.length;ab++){if(c[ab].getGroup()){vRowType="group"}else{vRowType="row"}J=c[ab].getID();var S=c[ab].getLineColor()?'style="background-color:'+c[ab].getLineColor()+'"':"";if(c[ab].getVisible()===0){C+='<tr id="child_'+J+'" class="g'+vRowType+' hidden" '+S+" onMouseover=\"g.mouseOver(this,'"+J+"','left','"+vRowType+"')\" onMouseout=\"g.mouseOut(this,'"+J+"','left','"+vRowType+"')\">"}else{C+='<tr id="child_'+J+'"  class="g'+vRowType+'" '+S+" onMouseover=\"g.mouseOver(this,'"+J+"','left','"+vRowType+"')\" onMouseout=\"g.mouseOut(this,'"+J+"','left','"+vRowType+"')\">"}if(w===1){C+='<td class="ggtaskCheckbox"><input type="checkbox" id="taskChecked-'+J+'" name="taskChecked" onclick="g.selectItem(this,\''+J+"');\"  "+(JSGantt.scope.selectedItems[J]?' checked="checked">':">")+'<label for="taskChecked-'+J+'"></label></td>'}C+='  <td class="ggTaskTitle ggCol'+T+'">';ae=(c[ab].getLevel()-1)*25;if(c[ab].getGroup()){var ah="ggroup-collapsed";if(c[ab].getOpen()==1){ah="ggroup-expanded"}if(c[ab].getSubProject()!=null){C+='<div id="group_'+(c[ab].getOpen()?"expanded":"collapsed")+"_"+J+'" style="margin-left:'+ae+'px;" class="onCollapsedAndExpanded" ><a href="#" class="'+JSGantt.scope.id+'-action-link"><span class="gicon '+(ah)+'"></span></a></div>'}else{C+='<div style="margin-left:'+ae+'px;" id="group_'+J+'" class="gicon '+ah+'" onclick="JSGantt.folder(\''+J+"',"+z+");"+z+'.DrawDependencies();"></div>'}}else{C+='<span  style="margin-left:'+ae+'px;">&nbsp;</span>'}if(c[ab].getSubProject()!=null){C+='<span class="project-title task-title" > '+c[ab].getName()+"</span></td>"}else{C+='<span class="task-title" > '+c[ab].getName()+"</span></td>"}if(u===1){C+='  <td class="ggCol'+T+'"  ><nobr>'+c[ab].getResource()+"</nobr></td>"}if(n===1){C+='  <td class="ggCol'+T+'"  ><nobr>'+c[ab].getDuration(b)+"</nobr></td>"}if(t===1){C+='  <td class="ggCol'+T+'"  ><nobr>'+c[ab].getCompStr()+"</nobr></td>"}if(o===1){C+='  <td class="ggCol'+T+'"  ><nobr>'+JSGantt.formatDateStr(c[ab].getStart(),i)+"</nobr></td>"}if(r===1){C+='  <td class="ggCol'+T+'"  ><nobr>'+JSGantt.formatDateStr(c[ab].getEnd(),i)+"</nobr></td>"}C+="</tr>"}C+="</td></tr>";C+="</tbody></table></td>";A+=C+"</div>";Z='<div class="scroll yui-u" id="rightside"><table style="width: '+aa+'px;" cellSpacing="0" cellPadding="0" border="0"><thead><tr class="gheader">';E.setFullYear(ac.getFullYear(),ac.getMonth(),ac.getDate());E.setHours(0);E.setMinutes(0);while(E.getTime()<=O.getTime()){Q=E.getFullYear()+"";Q=Q.substring(0,4);if(b=="minute"){Z+='<th class="gdatehead"   colspan="60">';Z+=JSGantt.formatDateStr(E,i)+" "+E.getHours()+":00 -"+E.getHours()+":59 </th>";E.setHours(E.getHours()+1)}if(b=="hour"){Z+='<th class="gdatehead"   colspan="24">';Z+=JSGantt.formatDateStr(E,i)+"</th>";E.setDate(E.getDate()+1)}if(b=="day"){Z+='<th class="gdatehead"   colspan="7"><center>'+E.getDate()+" - ";E.setDate(E.getDate()+6);Z+=JSGantt.formatDateStr(E,i)+"</center></th>";E.setDate(E.getDate()+1)}else{if(b=="week"){Z+='<th class="gdatehead"  width='+H+"px><center>"+Q+"</center></th>";E.setDate(E.getDate()+7)}else{if(b=="month"){Z+='<th class="gdatehead"  width='+H+"px><center>"+Q+"</center></th>";E.setDate(E.getDate()+1);while(E.getDate()>1){E.setDate(E.getDate()+1)}}else{if(b=="quarter"){Z+='<th class="gdatehead"   width='+H+"px><center>"+Q+"</center></th>";E.setDate(E.getDate()+81);while(E.getDate()>1){E.setDate(E.getDate()+1)}}}}}}Z+='</tr><tr class="gheader">';E.setFullYear(ac.getFullYear(),ac.getMonth(),ac.getDate());M.setFullYear(ac.getFullYear(),ac.getMonth(),ac.getDate());vNumCols=0;while(E.getTime()<=O.getTime()){var N="ghead",D="";if(b=="minute"){if(E.getMinutes()===0){N="ghead current";U=H*vNumCols}D=E.getMinutes();E.setMinutes(E.getMinutes()+1)}else{if(b=="hour"){if(E.getHours()===0){N="ghead current";U=H*vNumCols}D=E.getHours();E.setHours(E.getHours()+1)}else{if(b=="day"){if(E.getDay()%6===0){N="gheadwkend"}if(JSGantt.formatDateStr(F,"shortDate")==JSGantt.formatDateStr(E,"shortDate")){N+=" current";U=H*vNumCols}D=E.getDate();E.setDate(E.getDate()+1)}else{if(b=="week"){M.setDate(M.getDate()+7);if(F>=E&&F<M){N="ghead current";U=H*vNumCols}var Y=JSGantt.msg("jsgantt.dateformat");if(Y=="mm/dd/yyyy"){D=(E.getMonth()+1)+"/"+E.getDate()}else{D=E.getDate()+"/"+(E.getMonth()+1)}E.setDate(E.getDate()+7)}else{if(b=="month"){M.setFullYear(E.getFullYear(),E.getMonth(),x[E.getMonth()]);if(F>=E&&F<M){N="ghead current";U=H*vNumCols}D=y[E.getMonth()].substr(0,3);E.setDate(E.getDate()+1);while(E.getDate()>1){E.setDate(E.getDate()+1)}}else{if(b==="quarter"){M.setDate(M.getDate()+122);if(E.getMonth()===0||E.getMonth()===1||E.getMonth()===2){M.setFullYear(E.getFullYear(),2,31)}else{if(E.getMonth()===3||E.getMonth()===4||E.getMonth()===5){M.setFullYear(E.getFullYear(),5,30)}else{if(E.getMonth()===6||E.getMonth()===7||E.getMonth()===8){M.setFullYear(E.getFullYear(),8,30)}else{if(E.getMonth()===9||E.getMonth()===10||E.getMonth()===11){M.setFullYear(E.getFullYear(),11,31)}}}}if(F>=E&&F<M){N="ghead current";U=H*vNumCols}D=JSGantt.msg("jsgantt.quarter").substr(0,3)+". "+f[E.getMonth()];E.setDate(E.getDate()+81);while(E.getDate()>1){E.setDate(E.getDate()+1)}}}}}}}R+=this.renderDateHeaderCell(N,H,D);I+=this.renderDateCell(N,H);vNumCols++}Z+=R+"</tr>";Z+="</thead></table>";for(ab=0;ab<c.length;ab++){E.setFullYear(ac.getFullYear(),ac.getMonth(),ac.getDate());vTaskStart=c[ab].getStart();vTaskEnd=c[ab].getEnd();J=c[ab].getID();j=(c[ab].getEnd()-c[ab].getStart())/(24*60*60*1000)+1;if(b=="hour"){j=(c[ab].getEnd()-c[ab].getStart())/(60*1000)+1}else{if(b=="minute"){j=(c[ab].getEnd()-c[ab].getStart())/(60*1000)+1}}if(c[ab].getVisible()===0){Z+='<div id="childgrid_'+J+'" style="position:relative;" class="hidden" >'}else{Z+='<div id="childgrid_'+J+'" style="position:relative">'}if(b=="minute"){af=(c[ab].getEnd().getTime()-c[ab].getStart().getTime())/(60*1000)+1/G;P=Math.ceil((c[ab].getStart().getTime()-ac.getTime())/(60*1000))}else{if(b=="hour"){af=(c[ab].getEnd().getTime()-c[ab].getStart().getTime())/(60*60*1000)+1/G;P=(c[ab].getStart().getTime()-ac.getTime())/(60*60*1000)}else{af=(c[ab].getEnd().getTime()-c[ab].getStart().getTime())/(24*60*60*1000)+1/G;P=Math.ceil((c[ab].getStart().getTime()-ac.getTime())/(24*60*60*1000))}}if(g.getCaptionType()){vCaptionStr="";switch(g.getCaptionType()){case"Caption":vCaptionStr=c[ab].getCaption();break;case"Resource":vCaptionStr=c[ab].getResource();break;case"Duration":vCaptionStr=c[ab].getDuration(b);break;case"Complete":vCaptionStr=c[ab].getCompStr();break}}var L="row";if(c[ab].getMile()){L="mile"}else{if(c[ab].getGroup()){L="group"}}var S=c[ab].getLineColor()?'style="background-color:'+c[ab].getLineColor()+'"':"";Z+='<div><table style="width: '+aa+'px;"><tbody class="yui-dt-data"><tr id="childrow_'+J+'" '+S+' class="g'+L+'" onMouseover="g.mouseOver(this,\''+J+"','right','"+L+"')\" onMouseout=\"g.mouseOut(this,'"+J+"','right','"+L+"')\">"+I+"</tr></tbody></table></div>";if(c[ab].getMile()){R=JSGantt.formatDateStr(vTaskStart,i);Z+=this.renderMile(J,P,af,K,H,R,vCaptionStr,c[ab],b)}else{R=JSGantt.formatDateStr(vTaskStart,i)+" - "+JSGantt.formatDateStr(vTaskEnd,i);if(c[ab].getGroup()){var X=0,W="",V=0,ag="";for(X=ab+1;X<c.length;X++){if(!c[X].getGroup()&&c[X].getMile()&&c[X].getParent()==J){if(b=="minute"){V=Math.ceil((c[X].getStart().getTime()-ac.getTime())/(60*1000))}else{if(b=="hour"){V=(c[X].getStart().getTime()-ac.getTime())/(60*60*1000)}else{V=Math.ceil((c[X].getStart().getTime()-ac.getTime())/(24*60*60*1000))}}ag=JSGantt.formatDateStr(c[X].getStart(),i);if(K<6){V=V-Math.ceil(6/K)}W+='<div style="position:absolute;top:5px; left:'+Math.ceil(V*(K)+1)+"px; z-index:1; background-color:#"+c[X].getColor()+';" title="'+ag+'" class="milestone" >&nbsp;</div>'}}Z+=W+this.renderGroup(J,P,af,K,H,R,vCaptionStr,c[ab],b)}else{Z+=this.renderTask(J,P,af,K,H,R,vCaptionStr,c[ab],b)}}Z+="</div></div>"}A+=Z+"</div></div>";e.innerHTML=A}this.scrollToY(U,e)}catch(ad){alert(ad)}};this.renderMile=function(A,C,F,G,E,B,I,D,H){if(G<6){C=C-Math.ceil(6/G)}return'<div id="bardiv_'+A+'" style="position:absolute; top:3px; left:'+Math.ceil(C*(G)+1)+'px; height: 16px; width:266px; overflow:hidden;z-index:5;">  <div id="taskbar_'+A+'" title="'+B+'"  class="milestone '+(D.getCompVal()<100?"":"completed")+'" style="background-color:#'+D.getColor()+';">&nbsp;</div>'+((I!=null&&I.length>0)?'<div class="gcaption" style="top:0px; left:20px">'+I+"</div>":"")};this.renderTask=function(A,C,F,G,E,B,I,D,H){return'<div id="bardiv_'+A+'" style="position:absolute; top:4px; left:'+Math.ceil(C*(G)-1)+"px; height:18px;z-index:5; width:"+Math.ceil((F)*(G)-1)+'px"><div id="taskbar_'+A+'" title="'+B+'" class="gtask" style="background-color:#'+D.getColor()+"; width:"+Math.ceil((F)*(G)-1)+'px;"  ><div class="gcomplete" style="width:'+D.getCompStr()+';"></div></div>'+((I!=null&&I.length>0)?'<div class="gcaption" style="top:-3px; left:'+(Math.ceil((F)*(G)-1)+6)+'px">'+I+"</div>":"")};this.renderGroup=function(A,C,F,G,E,B,I,D,H){return'<div id="bardiv_'+A+'" style="position:absolute; top:8px; left:'+Math.ceil(C*(G)-1)+"px; height: 7px; width:"+Math.ceil((F)*(G)-1)+'px"><div id="taskbar_'+A+'" title="'+B+'" class="ggtask" style="width:'+Math.ceil((F)*(G)-1)+'px;"><div class="ggcomplete" style="width:'+D.getCompStr()+'" ></div></div>'+((I!=null&&I.length>0)?'<div class="gcaption" style="top:-3px; left:'+(Math.ceil((F)*(G)-1)+6)+'px">'+I+"</div>":"")};this.renderDateHeaderCell=function(B,C,A){return'<th class="'+B+'"  ><div style="width: '+C+'px">'+A+"</div></th>"};this.renderDateCell=function(A,B){return'<td class="'+A+'"  ><div style="width: '+B+'px">&nbsp;&nbsp;</div></td>'};this.selectItem=function(A,B){JSGantt.scope.selectedItems[B]=A.checked;YAHOO.Bubbling.fire(JSGantt.scope.scopeId+"selectedItemsChanged")};this.mouseOver=function(D,C,A,B){if(A=="right"){vcurrDivID="child_"+C}else{vcurrDivID="childrow_"+C}Dom.addClass(D,"highlight");Dom.addClass(vcurrDivID,"highlight")};this.mouseOut=function(D,C,A,B){if(A=="right"){vcurrDivID="child_"+C}else{vcurrDivID="childrow_"+C}Dom.removeClass(D,"highlight");Dom.removeClass(vcurrDivID,"highlight")}};JSGantt.processRows=function(d,r,o,e,c){var p=new Date();var f=new Date();var k=0;var m=0;var n=d;var b=e;var h=0;var l=0;var q=0;var j=c;for(h=0;h<d.length;h++){if(d[h].getParent()==r){j=c;d[h].setVisible(j);if(j==1&&d[h].getOpen()===0){j=0}d[h].setLevel(b);l++;if(d[h].getGroup()===1){JSGantt.processRows(n,d[h].getID(),h,b+1,j)}if(k===0||d[h].getStart()<p){p=d[h].getStart();k=1}if(m===0||d[h].getEnd()>f){f=d[h].getEnd();m=1}q+=d[h].getCompVal()}}if(o>=0&&!d[o].getMile()&&d[o].getSubProject()==null){d[o].setStart(p);d[o].setEnd(f);d[o].setNumKid(l)}};JSGantt.getMinDate=function a(e,d){var c=new Date(),f;c.setFullYear(e[0].getStart().getFullYear(),e[0].getStart().getMonth(),e[0].getStart().getDate());for(var b=0;b<e.length;b++){f=e[b].getStart();if(f.getTime()<c.getTime()){c.setFullYear(e[b].getStart().getFullYear(),e[b].getStart().getMonth(),e[b].getStart().getDate())}}if(d=="minute"){c.setHours(0);c.setMinutes(0)}else{if(d=="hour"){c.setHours(0);c.setMinutes(0)}else{if(d=="day"){c.setDate(c.getDate()-1);while(c.getDay()%7>0){c.setDate(c.getDate()-1)}}else{if(d=="week"){c.setDate(c.getDate()-7);while(c.getDay()%7>0){c.setDate(c.getDate()-1)}}else{if(d=="month"){while(c.getDate()>1){c.setDate(c.getDate()-1)}}else{if(d=="quarter"){if(c.getMonth()===0||c.getMonth()===1||c.getMonth()===2){c.setFullYear(c.getFullYear(),0,1)}else{if(c.getMonth()===3||c.getMonth()===4||c.getMonth()===5){c.setFullYear(c.getFullYear(),3,1)}else{if(c.getMonth()===6||c.getMonth()===7||c.getMonth()===8){c.setFullYear(c.getFullYear(),6,1)}else{if(c.getMonth()===9||c.getMonth()===10||c.getMonth()===11){c.setFullYear(c.getFullYear(),9,1)}}}}}}}}}}return(c)};JSGantt.getMaxDate=function(e,d){var c=new Date();c.setFullYear(e[0].getEnd().getFullYear(),e[0].getEnd().getMonth(),e[0].getEnd().getDate());for(var b=0;b<e.length;b++){if(e[b].getEnd().getTime()>c.getTime()){c.setTime(e[b].getEnd().getTime())}}if(d=="minute"){c.setHours(c.getHours()+1);c.setMinutes(59)}if(d=="hour"){c.setHours(c.getHours()+2)}if(d=="day"){c.setDate(c.getDate()+1);if(c.getDay()==0){c.setDate(c.getDate()+1)}while(c.getDay()%6>0){c.setDate(c.getDate()+1)}}if(d=="week"){c.setDate(c.getDate()+11);while(c.getDay()%6>0){c.setDate(c.getDate()+1)}}if(d=="month"){while(c.getDay()>1){c.setDate(c.getDate()+1)}c.setDate(c.getDate()-1)}if(d=="quarter"){if(c.getMonth()===0||c.getMonth()===1||c.getMonth()===2){c.setFullYear(c.getFullYear(),2,31)}else{if(c.getMonth()===3||c.getMonth()===4||c.getMonth()===5){c.setFullYear(c.getFullYear(),5,30)}else{if(c.getMonth()===6||c.getMonth()===7||c.getMonth()===8){c.setFullYear(c.getFullYear(),8,30)}else{if(c.getMonth()===9||c.getMonth()===10||c.getMonth()===11){c.setFullYear(c.getFullYear(),11,31)}}}}}return(c)};JSGantt.changeFormat=function(b,c){if(c){c.setFormat(b);c.DrawDependencies()}else{alert("Chart undefined")}};JSGantt.folder=function(b,d){var e=d.getList();for(var c=0;c<e.length;c++){if(e[c].getID()==b){if(e[c].getOpen()==1){e[c].setOpen(0);JSGantt.toogleDiv(b,d,0);Dom.removeClass("group_"+b,"ggroup-expanded");Dom.addClass("group_"+b,"ggroup-collapsed")}else{e[c].setOpen(1);JSGantt.toogleDiv(b,d,1);Dom.removeClass("group_"+b,"ggroup-collapsed");Dom.addClass("group_"+b,"ggroup-expanded")}}}};JSGantt.toogleDiv=function(b,e,h){var f=e.getList();var d=0;for(var c=0;c<f.length;c++){if(f[c].getParent()==b){d=f[c].getID();if(h==0){Dom.addClass("child_"+d,"hidden");Dom.addClass("childgrid_"+d,"hidden")}else{Dom.removeClass("child_"+d,"hidden");Dom.removeClass("childgrid_"+d,"hidden")}f[c].setVisible(h);if(f[c].getGroup()==1){JSGantt.toogleDiv(d,e,h)}}}};JSGantt.parseDateStr=function(b,d){if(b===null||b.length<1){return new Date()}if(b instanceof Date){return b}var c=Alfresco.util.fromISO8601(b);if(c===null){return new Date()}return c};JSGantt.formatDateStr=function(b,c){return Alfresco.util.formatDate(b,c)}})();