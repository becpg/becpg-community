
/**
* Pourcentage MP ds coût produit
*
**

with 
	member [Measures].[Coût produit] 
	as SUM([Source.Source par nom].[Nom source].Members,
		 [Measures].[Total des coûts])
	member [Measures].[PercentMP] 
	as ([Measures].[Total des coûts]/[Measures].[Coût produit]) , format_string = 'Percent'
	member [Measures].[AvgPercentMP]
	as AVG([Produits.Produit par nom].[Nom produit].Members,[Measures].[PercentMP])
select
 	NON EMPTY {[Measures].[Total des coûts],[Measures].[Coût produit], [Measures].[PercentMP],[Measures].[AvgPercentMP]} on ROWS,
    NON EMPTY CrossJoin([Produits.Produit par nom].[Nom produit].Members,[Source.Source par nom].[Nom source].Members) on COLUMNS
from [Analyse des coûts]




/**
*
* 10 MP les plus impactantes
*/

with member  [Measures].[AvgPercentMP]
	as AVG([Produits.Produit par nom].[Nom produit].Members,
		([Measures].[Total des coûts]/(SUM([Source.Source par nom].[Nom source].Members,
		 [Measures].[Total des coûts]))) ), format_string = 'Percent'
select
 	NON EMPTY {[Measures].[AvgPercentMP]} on COLUMNS,
    NON EMPTY TopCount([Source.Source par nom].[Nom source].Members,10,[Measures].[AvgPercentMP]) on ROWS
from [Analyse des coûts]

--> Pour graphique

with member  [Measures].[AvgPercentMP]
	as AVG([Produits.Produit par nom].[Nom produit].Members,
		([Measures].[Total des coûts]/(SUM([Source.Source par nom].[Nom source].Members,
		 [Measures].[Total des coûts]))) )*100
select
 	NON EMPTY {[Measures].[AvgPercentMP]} on COLUMNS,
    NON EMPTY TopCount([Source.Source par nom].[Nom source].Members,10,[Measures].[AvgPercentMP]) on ROWS
from [Analyse des coûts]

 
 
 
 