<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN 2.0//EN' 'http://www.springframework.org/dtd/spring-beans-2.0.dtd'>

<beans>

	<!-- beCPG configuration files -->
	<bean name="beCPGPlaceholderConfigurer"
		class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="ignoreUnresolvablePlaceholders" value="true" />
		<property name="ignoreResourceNotFound" value="true"></property>
		<property name="locations">
			<list>
				<value>classpath:alfresco/module/${pom.groupId}-${pom.artifactId}/beCPG.properties</value>
			</list>
		</property>
	</bean>
	
	<bean id="bootstrapMessages" class="org.alfresco.i18n.ResourceBundleBootstrapComponent">      
      <property name="resourceBundles">
         <list>
         	 <value>alfresco/module/${pom.groupId}-${pom.artifactId}/model/becpgModel</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/paths</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/product-types</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/states</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/becpg-messages</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/groups</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/demo</value>
             <value>alfresco/module/${pom.groupId}-${pom.artifactId}/messages/import-service</value>             
         </list>
      </property>      
   </bean>
	
	
	<!-- Admin -->
	<bean id="initRepoVisitor" class="fr.becpg.repo.admin.InitRepoVisitorImpl">
		<property name="fileFolderService" ref="fileFolderService" />
		<property name="nodeService" ref="nodeService" />
		<property name="repoService" ref="repoService" />
		<property name="ruleService" ref="ruleService" />
		<property name="actionService" ref="actionService" />
		<property name="productDictionaryService" ref="productDictionaryService" />
		<property name="authorityService" ref="authorityService" />
		<property name="permissionService" ref="permissionService"/>			
		<property name="reportTplService" ref="reportTplService"/>		
		<property name="contentService" ref="contentService" />
		<property name="mimetypeService" ref="mimetypeService"/>
		<property name="dictionaryService" ref="dictionaryService"/>
		<property name="entityTplService" ref="entityTplService"/>
		<property name="beCPGMailService" ref="becpgMailService"/>		
	</bean>
	<bean id="initSiteVisitor" class="fr.becpg.repo.admin.InitSiteVisitorImpl">
		<property name="fileFolderService" ref="fileFolderService" />
		<property name="nodeService" ref="nodeService" />
		<property name="repoService" ref="repoService" />
		<property name="ruleService" ref="ruleService" />
		<property name="actionService" ref="actionService" />
		<property name="productDictionaryService" ref="productDictionaryService" />			
	</bean>
	<bean id="initDemoVisitor" class="fr.becpg.repo.admin.InitDemoVisitorImpl">
		<property name="personService" ref="personService" />
		<property name="authorityService" ref="authorityService" />
		<property name="siteService" ref="siteService" />			
	</bean>	

	<!-- dynListConstraint -->
	<bean id="dynListConstraint" class="fr.becpg.repo.dictionary.constraint.DynListConstraint">
		<property name="serviceRegistry" ref="ServiceRegistry" />
	</bean>

	<!-- Helper -->
	<bean id="repoService" class="fr.becpg.repo.helper.RepoServiceImpl">		
		<property name="nodeService" ref="nodeService" />
		<property name="searchService" ref="searchService" />
		<property name="namespaceService" ref="namespaceService"/>
	</bean>
	<bean id="propertyService" class="fr.becpg.repo.helper.PropertyServiceImpl">		
		<property name="nodeService" ref="nodeService" />
	</bean>
	<bean id="associationService" class="fr.becpg.repo.helper.AssociationServiceImpl">		
		<property name="nodeService" ref="nodeService" />
	</bean>	

	<!-- Importer -->
	<bean id="importService" class="fr.becpg.repo.importer.impl.ImportServiceImpl">
		<property name="searchService" ref="searchService" />
		<property name="nodeService" ref="nodeService" />
		<property name="contentService" ref="contentService" />
		<property name="serviceRegistry" ref="ServiceRegistry" />
		<property name="repoService" ref="repoService" />
		<property name="repositoryHelper" ref="repositoryHelper" />
		<property name="importNodeVisitor" ref="importNodeVisitor" />
		<property name="importProductVisitor" ref="importProductVisitor" />
		<property name="importEntityListAspectVisitor" ref="importEntityListAspectVisitor" />
		<property name="importEntityListItemVisitor" ref="importEntityListItemVisitor" />				
		<property name="dictionaryService" ref="dictionaryService" />
	</bean>
	<bean id="importNodeVisitor" class="fr.becpg.repo.importer.impl.ImportNodeVisitor">		
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="serviceRegistry" ref="ServiceRegistry" />
		<property name="nodeService" ref="nodeService" />
		<property name="listValueService" ref="listValueService" />
		<property name="searchService" ref="searchService" />
		<property name="repoService" ref="repoService" />
		<property name="contentService" ref="contentService" />
		<property name="mimetypeService" ref="mimetypeService"/>
		<property name="namespaceService" ref="namespaceService"/>
	</bean>	
	<bean id="importProductVisitor" class="fr.becpg.repo.importer.impl.ImportProductVisitor">
		<property name="nodeService" ref="nodeService" />		
		<property name="serviceRegistry" ref="ServiceRegistry" />
		<property name="entityListDAO" ref="entityListDAO" />
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="listValueService" ref="listValueService" />
		<property name="searchService" ref="searchService" />
		<property name="repoService" ref="repoService" />
		<property name="contentService" ref="contentService" />
		<property name="mimetypeService" ref="mimetypeService"/>		
		<property name="namespaceService" ref="namespaceService"/>
		<property name="productService" ref="productService" />
		<property name="repositoryHelper" ref="repositoryHelper" />
	</bean>
	<bean id="importEntityListAspectVisitor" class="fr.becpg.repo.importer.impl.ImportEntityListAspectVisitor">
		<property name="nodeService" ref="nodeService" />		
		<property name="serviceRegistry" ref="ServiceRegistry" />
		<property name="entityListDAO" ref="entityListDAO" />
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="listValueService" ref="listValueService" />
		<property name="searchService" ref="searchService" />
		<property name="repoService" ref="repoService" />
		<property name="contentService" ref="contentService" />
		<property name="mimetypeService" ref="mimetypeService"/>		
		<property name="namespaceService" ref="namespaceService"/>
	</bean>
	<bean id="importEntityListItemVisitor" class="fr.becpg.repo.importer.impl.ImportEntityListItemVisitor">
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="serviceRegistry" ref="ServiceRegistry" />
		<property name="nodeService" ref="nodeService" />
		<property name="listValueService" ref="listValueService" />
		<property name="searchService" ref="searchService" />
		<property name="repoService" ref="repoService" />
		<property name="contentService" ref="contentService" />
		<property name="mimetypeService" ref="mimetypeService"/>
		<property name="namespaceService" ref="namespaceService"/>
		<property name="entityListDAO" ref="entityListDAO" />
		<property name="fileFolderService" ref="fileFolderService" />
	</bean>
	<bean id="userImporterService" class="fr.becpg.repo.importer.user.impl.UserImporterServiceImpl">
		<property name="authenticationService" ref="authenticationService"/>
		<property name="contentService" ref="contentService"/>
		<property name="nodeService" ref="nodeService"/>
		<property name="personService" ref="personService"/>
		<property name="siteService" ref="siteService"/>
		<property name="authorityService" ref="authorityService"/>
	    <property name="beCPGMailService" ref="becpgMailService"/>
	    <property name="namespacePrefixResolver" ref="namespaceService" />
	</bean>
	
	<!-- Mail service -->
	
	<bean id="becpgMailService" class="fr.becpg.repo.mail.impl.BeCPGMailServiceImpl">
		<property name="nodeService" ref="nodeService"/>
    	<property name="mailService" ref="mailService"/>   
    	<property name="templateService" ref="templateService"/>
    	<property name="serviceRegistry" ref="ServiceRegistry"/>
    	<property name="mailFrom" value="${mail.from.default}" />
    	<property name="searchService" ref="searchService"/>
	</bean>
	
	<!-- EntityVersion -->
	<bean id="entityVersionService" class="fr.becpg.repo.entity.version.EntityVersionServiceImpl">
		<property name="nodeService" ref="nodeService" />		
		<property name="copyService" ref="copyService" />	
	   	<property name="personService" ref="personService" />
	   	<property name="searchService" ref="searchService" />
	   	<property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
	</bean>
	
	<!-- EntityCheckOutCheckIn -->
	<bean id="entityCheckOutCheckInService" class="fr.becpg.repo.entity.version.EntityCheckOutCheckInServiceImpl" parent="checkOutCheckInService">
		<property name="nodeService" ref="nodeService" />		
		<property name="lockService" ref="lockService" />		
		<property name="copyService" ref="copyService" />	
   	<property name="ruleService" ref="ruleService" />
   	<property name="entityListDAO" ref="entityListDAO" />
   	<property name="entityVersionService" ref="entityVersionService" />
   	<property name="authenticationService" ref="authenticationService" />
   	<property name="permissionService" ref="permissionService"/>
   	<property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
	</bean>
	
	<!-- CompareEntityService -->
	<bean id="compareEntityService" class="fr.becpg.repo.entity.comparison.CompareEntityServiceImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="fileFolderService" ref="fileFolderService" />
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="namespaceService" ref="namespaceService"/>
		<property name="propertyService" ref="propertyService"/>
		<property name="entityListDAO" ref="entityListDAO"/>
	</bean>
	
	
	
	<!-- ListValue -->
	<bean id="listValueService" class="fr.becpg.repo.listvalue.ListValueServiceImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="beCPGSearchService" ref="beCPGSearchService" />
		<property name="reportTplService" ref="reportTplService" />
		<property name="dictionaryDAO" ref="dictionaryDAO"/>
		<property name="dictionaryService" ref="dictionaryService"/>
		<property name="autoNumService" ref="autoNumService"/>
	</bean>
	
	<!-- Entity -->
	<bean id="entityListDAO" class="fr.becpg.repo.entity.impl.EntityListDAOImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="dictionaryService" ref="dictionaryService" />		
		<property name="fileFolderService" ref="fileFolderService"/>	
		<property name="namespaceService" ref="namespaceService"/>
		<property name="copyService" ref="copyService" />
	</bean>
	<bean id="entityTplService" class="fr.becpg.repo.entity.impl.EntityTplServiceImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="entityListDAO" ref="entityListDAO" />
		<property name="searchService" ref="searchService" />
		<property name="dictionaryService" ref="dictionaryService" />		
	</bean>
	<bean id="entityService" class="fr.becpg.repo.entity.impl.EntityServiceImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="entityListDAO" ref="entityListDAO" />
		<property name="searchService" ref="searchService" />
		<property name="fileFolderService" ref="fileFolderService" />
		<property name="permissionService" ref="permissionService" />
		<property name="entityTplService" ref="entityTplService"/>
	</bean>
	<bean id="entityDictionaryService" class="fr.becpg.repo.entity.impl.EntityDictionaryServiceImpl">
	</bean>
	<!-- Entity Policies-->
	<bean id="autoNumService" class="fr.becpg.repo.entity.impl.AutoNumServiceImpl">
		<property name="searchService" ref="searchService" />
		<property name="nodeService" ref="nodeService" />
		<property name="repoService" ref="repoService" />
		<property name="repositoryHelper" ref="repositoryHelper" />
		<property name="dictionaryService" ref="dictionaryService"/>
	</bean>
	<bean id="codePolicy" class="fr.becpg.repo.entity.policy.CodePolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="nodeService" ref="nodeService" />
		<property name="autoNumService" ref="autoNumService" />
		<property name="searchService" ref="searchService" />
	</bean>
	<bean id="entityPolicy" class="fr.becpg.repo.entity.policy.EntityPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="entityService" ref="entityService" />		
	</bean>
	<bean id="initEntityListPolicy" class="fr.becpg.repo.entity.policy.InitEntityListPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="nodeService" ref="nodeService" />
		<property name="namespaceService" ref="namespaceService"/>
		<property name="dictionaryService" ref="dictionaryService" />
	</bean>
	<bean id="auditEntityListItemPolicies" class="fr.becpg.repo.entity.policy.AuditEntityListItemPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="nodeService" ref="nodeService" />		
		<property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
		<property name="authenticationService" ref="authenticationService" />
	</bean>	
	<bean id="sortableListPolicy" class="fr.becpg.repo.entity.policy.SortableListPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="nodeService" ref="nodeService" />
		<property name="beCPGSearchService" ref="beCPGSearchService" />
		<property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
	</bean>
	

	<!-- Product dictionary -->
	<bean id="productDictionaryService" class="fr.becpg.repo.product.ProductDictionaryServiceImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="searchService" ref="searchService" />
		<property name="fileFolderService" ref="fileFolderService" />		
		<property name="repositoryHelper" ref="repositoryHelper" />
		<property name="repoService" ref="repoService"/>
	</bean>

	<!-- Product DAO -->
	<bean id="productDAO" class="fr.becpg.repo.product.ProductDAOImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="mlNodeService" ref="mlAwareNodeService" />
		<property name="entityListDAO" ref="entityListDAO"/>
		<property name="policyBehaviourFilter" ref="policyBehaviourFilter" />
	</bean>

	<!-- Product -->
	<bean id="productService" class="fr.becpg.repo.product.ProductServiceImpl">
		<property name="nodeService" ref="nodeService" />
		<property name="fileFolderService" ref="fileFolderService" />
		<property name="productDAO" ref="productDAO" />		
		<property name="productDictionaryService" ref="productDictionaryService" />		
		<property name="productReportVisitor" ref="productReportVisitor" />		
		<property name="compositionCalculatingVisitor" ref="compositionCalculatingVisitor" />
		<property name="allergensCalculatingVisitor" ref="allergensCalculatingVisitor" />
		<property name="nutsCalculatingVisitor" ref="nutsCalculatingVisitor" />
		<property name="costsCalculatingVisitor" ref="costsCalculatingVisitor" />
		<property name="ingsCalculatingVisitor" ref="ingsCalculatingVisitor" />		
		<property name="repoService" ref="repoService" />
		<property name="permissionService" ref="permissionService"/>
		<property name="ownableService" ref="ownableService"/>
		<property name="policyBehaviourFilter" ref="policyBehaviourFilter" />		
		<property name="lockService" ref="lockService" />
	</bean>
	
	<!-- Product report -->
	<bean id="productReportService" class="fr.becpg.repo.product.report.ProductReportServiceImpl">
		<property name="nodeService" ref="nodeService" />		
	</bean>
	<bean id="productReportVisitor" class="fr.becpg.repo.product.report.ProductReportVisitor">
		<property name="productDictionaryService" ref="productDictionaryService" />
		<property name="productDAO" ref="productDAO" />		
		<property name="productReportService" ref="productReportService" />
		<property name="reportTplService" ref="reportTplService" />	
		<property name="entityReportService" ref="entityReportService" />	
		<property name="entityService" ref="entityService"/>
	</bean>
	
	<!-- Formulation visitors -->
	<bean id="compositionCalculatingVisitor"
		class="fr.becpg.repo.product.formulation.CompositionCalculatingVisitor">
		<property name="nodeService" ref="nodeService" />
	</bean>
	<bean id="allergensCalculatingVisitor"
		class="fr.becpg.repo.product.formulation.AllergensCalculatingVisitor">
		<property name="productDAO" ref="productDAO" />
	</bean>
	<bean id="ingsCalculatingVisitor"
		class="fr.becpg.repo.product.formulation.IngsCalculatingVisitor">
		<property name="nodeService" ref="nodeService" />
		<property name="productDAO" ref="productDAO" />
		<property name="mlNodeService" ref="mlAwareNodeService" />
	</bean>
	<bean id="nutsCalculatingVisitor"
		class="fr.becpg.repo.product.formulation.NutsCalculatingVisitor">
		<property name="nodeService" ref="nodeService" />
		<property name="productDAO" ref="productDAO" />
	</bean>
	<bean id="costsCalculatingVisitor"
		class="fr.becpg.repo.product.formulation.CostsCalculatingVisitor">
		<property name="nodeService" ref="nodeService" />
		<property name="productDAO" ref="productDAO" />
	</bean>
	
	<!-- Product Policies -->	
	<bean id="generateProductReportPolicy" class="fr.becpg.repo.product.policy.GenerateProductReportPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="transactionService" ref="transactionService"/>
		<property name="threadPoolExecutor" ref="indexThreadPoolExecutor" />
		<property name="productService" ref="productService" />
		<property name="nodeService" ref="nodeService" />
	</bean>		
	<bean id="productListUnits.ProductPolicy" class="fr.becpg.repo.product.policy.productListUnits.ProductPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="nodeService" ref="nodeService" />
		<property name="entityListDAO" ref="entityListDAO" />
		<property name="fileFolderService" ref="fileFolderService" />
	</bean>
	<bean id="productListUnits.ProductListPolicy" class="fr.becpg.repo.product.policy.productListUnits.ProductListPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent" />
		<property name="nodeService" ref="nodeService" />
	</bean>
	
	<!-- Search -->
	<bean id="advSearchService" class="fr.becpg.repo.search.AdvSearchServiceImpl">
		<property name="searchService" ref="SearchService" />
		<property name="nodeService" ref="nodeService" />
		<property name="dictionaryService" ref="dictionaryService" />
		<property name="namespaceService" ref="namespaceService" />			
	</bean>		
	<bean id="beCPGSearchService" class="fr.becpg.repo.search.BeCPGSearchServiceImpl">
		<property name="searchService" ref="SearchService" />
		<property name="unProtSearchService" ref="searchService" />	
	</bean>
	
		   	
  <!-- Thumbnail service implementation bean -->
    <bean id="thumbnailService" class="fr.becpg.repo.thumbnail.impl.BeCPGThumbnailServiceImpl">
    	<property name="nodeService" ref="nodeService"/>
        <property name="renditionService" ref="renditionService" />
    	<property name="thumbnailRegistry" ref="thumbnailRegistry" />
    	<property name="entityService" ref="entityService"/>
    	<property name="dictionaryService" ref="dictionaryService"/>
    	<property name="searchService" ref="searchService"/>
    </bean>
    
</beans>
