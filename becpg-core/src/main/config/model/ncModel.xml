<?xml version="1.0" encoding="UTF-8"?>
<!-- Definition of new Model -->
<model name="nc:ncmodel" xmlns="http://www.alfresco.org/model/dictionary/1.0">
	<!-- Optional meta-data about the model -->
	<description>Non Conformity Model</description>
	<author>Laborie Matthieu</author>
	<version>1.0</version>
	<!-- Imports are required to allow references to definitions in other models -->
	<imports>
		<!-- Import Alfresco Dictionary Definitions -->
		<import uri="http://www.alfresco.org/model/dictionary/1.0"
			prefix="d" />
		<!-- Import Alfresco Content Domain Model Definitions -->
		<import uri="http://www.alfresco.org/model/content/1.0" prefix="cm" />
		<import uri="http://www.alfresco.org/model/datalist/1.0"
			prefix="dl" />
		<import uri="http://www.bcpg.fr/model/becpg/1.0" prefix="bcpg" />
	</imports>
	<!-- Introduction of new namespaces defined by this model -->
	<namespaces>
		<namespace uri="http://www.bcpg.fr/model/nc/1.0" prefix="nc" />
	</namespaces>

	<constraints>
		<constraint name="nc:acType" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>Correction</value>
					<value>Déclassement</value>
					<value>Destruction</value>
					<value>Blocage produit</value>
				</list>
			</parameter>
		</constraint>
		<constraint name="nc:acEfficiency" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>Satisfaisante</value>
					<value>Partielle</value>
					<value>Non satisfaisante</value>
				</list>
			</parameter>
		</constraint>
		<constraint name="nc:ncType" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>Physico-chimie</value>
					<value>Poids</value>
					<value>Microbiologie</value>
					<value>Corps étranger environnement</value>
					<value>Corps étranger ligne</value>
					<value>DLC</value>
					<value>DLUO</value>
				</list>
			</parameter>
		</constraint>
		<constraint name="nc:ncCreationStep" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>Réception</value>
					<value>Transport</value>
					<value>Fabrication</value>
					<value>Livraison</value>
					<value>Client</value>
				</list>
			</parameter>
		</constraint>
		<constraint name="nc:ncDetectionStep" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>Réception</value>
					<value>Transport</value>
					<value>Fabrication</value>
					<value>Livraison</value>
					<value>Client</value>
				</list>
			</parameter>
		</constraint>
		<constraint name="nc:ncSeverity" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value>Faible</value>
					<value>Élevé</value>
					<value>Critique</value>
				</list>
			</parameter>
		</constraint>

		<constraint name="nc:ncQuantityNcUnit" type="LIST">
			<parameter name="allowedValues">
				<list>
					<value></value>
					<value>kg</value>
					<value>L</value>
					<value>P</value>
					<value>m</value>
					<value>m2</value>
				</list>
			</parameter>
		</constraint>

	</constraints>
	<types>

		<!-- Non conformité -->

		<type name="nc:nc">
			<parent>cm:content</parent>
			<properties>
				<property name="nc:ncType">
					<type>d:text</type>
					<mandatory>true</mandatory>
					<constraints>
						<constraint ref="nc:ncType" />
					</constraints>
				</property>
				<property name="nc:ncCreationStep">
					<type>d:text</type>
					<mandatory>true</mandatory>
					<constraints>
						<constraint ref="nc:ncCreationStep" />
					</constraints>
				</property>
				<property name="nc:ncDateCreation">
					<type>d:datetime</type>
					<mandatory>true</mandatory>
				</property>
				<property name="nc:ncQuantityNc">
					<type>d:float</type>
					<mandatory>true</mandatory>
					
				</property>
				<property name="nc:ncQuantityNcUnit">
					<type>d:text</type>
					<mandatory>true</mandatory>
					<constraints>
						<constraint ref="nc:ncQuantityNcUnit" />
					</constraints>
				</property>
				<property name="nc:ncService">
					<type>d:text</type>
					<mandatory>true</mandatory>
				</property>
				<property name="nc:ncCode">
					<type>d:text</type>
					<mandatory>true</mandatory>
				</property>
				<property name="nc:ncSeverity">
					<type>d:text</type>
					<mandatory>true</mandatory>
					<constraints>
						<constraint ref="nc:ncSeverity" />
					</constraints>
				</property>
				<property name="nc:ncDetectionStep">
					<type>d:text</type>
					<mandatory>true</mandatory>
					<constraints>
						<constraint ref="nc:ncDetectionStep" />
					</constraints>
				</property>
				<property name="nc:ncDateDetection">
					<type>d:datetime</type>
					<mandatory>true</mandatory>
				</property>
				<property name="nc:ncCost">
					<type>d:float</type>
					<mandatory>true</mandatory>
				</property>
				<property name="nc:ncCostUnit">
					<type>d:text</type>
					<mandatory>true</mandatory>
					<constraints>
						<constraint ref="bcpg:costListUnit" />
					</constraints>
				</property>
				<property name="nc:ncCause">
					<type>d:text</type>
					<mandatory>true</mandatory>
				</property>
				<property name="nc:ncComments">
					<type>d:text</type>
					<mandatory>true</mandatory>
				</property>
			</properties>
			<mandatory-aspects>
				<aspect>cm:titled</aspect>
				<aspect>nc:ncProductAspect</aspect>
				<aspect>nc:ncIdentificationAspect</aspect>
			</mandatory-aspects>
		</type>



	</types>
	<!-- ASPECTS -->

	<aspects>


		<aspect name="nc:ncIdentificationAspect">
			<properties>
				<property name="nc:ncBatchNumber">
					<type>d:text</type>
				</property>
				<property name="nc:ncOrderNb">
					<type>d:text</type>
				</property>
				<property name="nc:ncBatchComments">
					<type>d:text</type>
				</property>
			</properties>
		</aspect>

		<aspect name="nc:ncProductAspect">
			<properties>
				<property name="nc:ncProductFamilly">
					<type>d:text</type>
				</property>
			</properties>
			<associations>
				<association name="nc:ncProduct">
					<source>
						<mandatory>false</mandatory>
						<many>true</many>
					</source>
					<target>
						<class>bcpg:product</class>
						<mandatory>true</mandatory>
						<many>false</many>
					</target>
				</association>
			</associations>
		</aspect>



		<!-- Action corrective -->

		<aspect name="nc:ncAcAspect">
			<properties>
				<property name="nc:acType">
					<type>d:text</type>
					<constraints>
						<constraint ref="nc:acType" />
					</constraints>
				</property>
				<property name="nc:acPreviDate">
					<type>d:datetime</type>
				</property>
				<property name="nc:acRealisationDate">
					<type>d:datetime</type>
				</property>
				<property name="nc:acVerificationDate">
					<type>d:datetime</type>
				</property>
				<property name="nc:acComments">
					<type>d:text</type>
				</property>
				<property name="nc:acSpeaker">
					<type>d:text</type>
				</property>
				<property name="nc:acDescription">
					<type>d:text</type>
				</property>
				<property name="nc:acEfficiency">
					<type>d:text</type>
					<constraints>
						<constraint ref="nc:acEfficiency" />
					</constraints>
				</property>
				<property name="nc:acChecker">
					<type>d:text</type>
				</property>
			</properties>
		</aspect>



	</aspects>

</model>
