<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.bcpg.fr/model/workflow/1.0">
  <process id="claimProcess" name="Claim Process" isExecutable="true">
    <documentation>Place documentation for the 'claim-process' process here.</documentation>
    <startEvent id="startClaimProcess" name="Saisie réclamation" activiti:formKey="ncwf:claimStartTask"></startEvent>
    <sequenceFlow id="startFlow" sourceRef="startClaimProcess" targetRef="initialiseNCTask">
      <extensionElements>
        <activiti:executionListener event="start" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
          <activiti:field name="script">
            <activiti:string>execution.setVariable('ncwf_claimRejectedState','none');
	                execution.setVariable('ncwf_ncType',"Claim");
	                if(execution.getVariable('bcpgwf_notifyUsers')==null){
	                	execution.setVariable('bcpgwf_notifyUsers',null);
	                }
	                execution.setVariable('ncwf_ncState',"analysis");
	                if(execution.getVariable('ncwf_claimStartAsDraft')==null){
	                 	 execution.setVariable('ncwf_claimStartAsDraft',false);
	                }
	                execution.setVariable('skipClassification',false);</activiti:string>
          </activiti:field>
        </activiti:executionListener>
      </extensionElements>
    </sequenceFlow>
    <serviceTask id="initialiseNCTask" name="Initialisation réclamation" activiti:delegateExpression="${CreateNC}"></serviceTask>
    <userTask id="enteringClaimTask" name="Saisie réclamation" activiti:assignee="${initiator.properties.userName}" activiti:candidateUsers="initiator" activiti:formKey="ncwf:claimStartTask">
      <extensionElements>
        <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
          <activiti:field name="script">
            <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
            task.setVariable('ncwf_claimRejectedCause',  execution.getVariable('ncwf_claimRejectedCause'));
            task.setVariable('bpm_workflowDueDate',  execution.getVariable('bpm_workflowDueDate'));
            task.setVariable('bpm_workflowPriority',  execution.getVariable('bpm_workflowPriority'));
            		for (var i = 0; i &lt; bpm_package.children.length; i++)
						{
							var nc = bpm_package.children[i];
							if(nc.isSubType("qa:nc")){
							   bpm_workflowDescription = extractName(nc);
								task.setVariable('bpm_workflowDescription',bpm_workflowDescription);
							}
						}</activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
          <activiti:field name="script">
            <activiti:string>execution.setVariable('ncwf_claimRejectedState','none');
                  execution.setVariable('ncwf_claimRejectedCause','');
                  
                  execution.setVariable('qa_claimSource', task.getVariable('qa_claimSource'));
	             
	               execution.setVariable('bcpg_clients', task.getVariable('bcpg_clients'));
						execution.setVariable('qa_claimCustomerInformation', task.getVariable('qa_claimCustomerInformation'));
						
						execution.setVariable('qa_product', task.getVariable('qa_product'));
						
						execution.setVariable('qa_batchId', task.getVariable('qa_batchId'));
						execution.setVariable('qa_productUseByDate', task.getVariable('qa_productUseByDate'));
						execution.setVariable('qa_claimTradeContact', task.getVariable('qa_claimTradeContact'));
						execution.setVariable('qa_claimTradeContactCheck', task.getVariable('qa_claimTradeContactCheck'));
						execution.setVariable('qa_claimTracking', task.getVariable('qa_claimTracking'));
						execution.setVariable('qa_claimDescription', task.getVariable('qa_claimDescription'));
			
                  execution.setVariable('bcpgwf_notifyAssignee', task.getVariable('bcpgwf_notifyAssignee'));
        			   execution.setVariable('bcpgwf_notifyUsers', task.getVariable('bcpgwf_notifyUsers'));
        			   execution.setVariable('bcpgwf_notifyMe', task.getVariable('bcpgwf_notifyMe'));
        			   
        			   execution.setVariable('bpm_workflowDueDate', task.getVariable('bpm_workflowDueDate'));
        			   execution.setVariable('bpm_workflowPriority', task.getVariable('bpm_workflowPriority'));
                  
                  execution.setVariable('skipClassification',false);
                   
            	   task.setVariable('ncwf_ncState',"analysis");</activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="complete" class="fr.becpg.repo.workflow.activiti.nc.UpdateNC"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <userTask id="analysisTask" name="Orientation réclamation" activiti:candidateGroups="GROUP_ClaimAnalysis" activiti:formKey="ncwf:claimAnalysisTask">
      <extensionElements>
        <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
          <activiti:field name="script">
            <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
							
	               if (typeof bpm_workflowDueDate != 'undefined') task.dueDate = bpm_workflowDueDate;
	               if (typeof bpm_workflowPriority != 'undefined') task.priority = bpm_workflowPriority;
	               task.setVariable('bpm_comment', '');
				
	               for (var i = 0; i &lt; bpm_package.children.length; i++)
						{
							var nc = bpm_package.children[i];
							if(nc.isSubType("qa:nc")){
							   bpm_workflowDescription = extractName(nc);
								task.setVariable('bpm_workflowDescription',bpm_workflowDescription);
							}
						}
						
	               var tDate = new  java.util.Date();
		            	tDate.setDate(tDate.getDate()+5);
	               var rDate = new  java.util.Date();
		            	rDate.setDate(rDate.getDate()+9);
	            
	               task.setVariable('ncwf_claimTreatmentDueDate', tDate);
	               task.setVariable('ncwf_claimResponseDueDate',  rDate); 
	               
	               task.setVariable('ncwf_claimRejectedCause',  execution.getVariable('ncwf_claimRejectedCause'));
	               task.setVariable('ncwf_claimRejectedState', 'none');
	               
	              if (bcpgwf_notifyUsers != null)  {
				           	for (var i = 0; i &lt; bcpgwf_notifyUsers.size(); i++){
									sendMail(bcpgwf_notifyUsers.get(i),	initiator,bcpg.getMessage('claimProcess.mail.notify.analysis.subject',bpm_workflowDescription), bcpg.getMessage('claimProcess.mail.notify.analysis.message'));
								}
				      }</activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
          <activiti:field name="script">
            <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
               execution.setVariable('ncwf_claimTreatmentDueDate', task.getVariable('ncwf_claimTreatmentDueDate'));
               execution.setVariable('ncwf_claimResponseDueDate',  task.getVariable('ncwf_claimResponseDueDate'));
               
               task.setVariable('ncwf_ncState', 'classification');
               
               if(task.getVariable('qa_claimResponseActor')!=null ){
	                execution.setVariable('qa_claimResponseActor',task.getVariable('qa_claimResponseActor'));
	                task.setVariable('ncwf_ncState','response');
	            } else {
	                execution.setVariable('qa_claimResponseActor',null);
	            }
               
               if(task.getVariable('qa_claimTreatmentActor')!=null ){
                  execution.setVariable('qa_claimTreatmentActor',task.getVariable('qa_claimTreatmentActor'));
                  task.setVariable('ncwf_ncState','treatment');
               } else {
                  execution.setVariable('qa_claimTreatmentActor',null);
               }
	            
               
               if(task.getVariable('ncwf_claimRejectedState')!='none'){
                 task.setVariable('ncwf_ncState',"new");
                 execution.setVariable('ncwf_claimRejectedCause',  task.getVariable('ncwf_claimRejectedCause'));
               } else {
                 execution.setVariable('ncwf_claimRejectedCause',  '');
                 
                 
                 if (bcpgwf_notifyUsers != null)  {
				          for (var i = 0; i &lt; bcpgwf_notifyUsers.size(); i++){
								sendMail(bcpgwf_notifyUsers.get(i),initiator, bcpg.getMessage('claimProcess.mail.notify.analysis.end.subject',bpm_workflowDescription), bcpg.getMessage('claimProcess.mail.notify.analysis.end.message'));
			          	}
			          }
			          if(bcpgwf_notifyMe){
			             sendMail(initiator,initiator,  bcpg.getMessage('claimProcess.mail.notify.analysis.end.subject',bpm_workflowDescription),	 bcpg.getMessage('claimProcess.mail.notify.analysis.end.message'));
			          }
                 
               }
               
               execution.setVariable('bcpg_plants', task.getVariable('bcpg_plants'));
               
               execution.setVariable('bcpgwf_notifyAssignee', task.getVariable('bcpgwf_notifyAssignee'));
        			execution.setVariable('bcpgwf_notifyUsers', task.getVariable('bcpgwf_notifyUsers'));
               execution.setVariable('ncwf_claimRejectedState',  task.getVariable('ncwf_claimRejectedState'));</activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="complete" class="fr.becpg.repo.workflow.activiti.nc.UpdateNC"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="toDispatchTreatmentGateway" sourceRef="endOrientationGateway" targetRef="subprocess1">
      <extensionElements>
        <activiti:executionListener event="take" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
          <activiti:field name="script">
            <activiti:string>logger.info("Go To Dispatch Treatment Gateway ");
            			logger.info("State :  "+ncwf_claimRejectedState);
            			logger.info("Treatment Actor: "+(qa_claimTreatmentActor!=null));
            			logger.info("Response Actor: "+(qa_claimResponseActor!=null));
            			logger.info("Skip classification: "+skipClassification);</activiti:string>
          </activiti:field>
        </activiti:executionListener>
      </extensionElements>
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimRejectedState != 'entry' && ncwf_claimRejectedState != 'analysis'}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="claimClosingTask" name="Clôture réclamation" activiti:candidateGroups="GROUP_ClaimClosing" activiti:formKey="ncwf:claimClosingTask">
      <extensionElements>
        <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
          <activiti:field name="script">
            <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
						
           		if (typeof bpm_workflowDueDate != 'undefined') task.dueDate = bpm_workflowDueDate;
               if (typeof bpm_workflowPriority != 'undefined') task.priority = bpm_workflowPriority;
					
					task.setVariable('bpm_comment', '');
					
		           if (bcpgwf_notifyUsers != null)  {
					       for (var i = 0; i &lt; bcpgwf_notifyUsers.size(); i++){
										sendMail(initiator,initiator, 
						    		   bcpg.getMessage('claimProcess.mail.notify.closing.subject',bpm_workflowDescription),
								    	bcpg.getMessage('claimProcess.mail.notify.closing.message'));  
									}	
				      }
				      if(bcpgwf_notifyMe){
				             sendMail(initiator,initiator, 
						      bcpg.getMessage('claimProcess.mail.notify.closing.subject',bpm_workflowDescription),
						      bcpg.getMessage('claimProcess.mail.notify.closing.message'));  
						 }
							  
				
               
               task.setVariable('qa_claimResponseState', execution.getVariable('qa_claimResponseState'));
			   	task.setVariable('qa_claimResponseDetails', execution.getVariable('qa_claimResponseDetails'));
			   	task.setVariable('qa_claimTreatementDetails', execution.getVariable('qa_claimTreatementDetails'));
			   	task.setVariable('qa_claimType', execution.getVariable('qa_claimType'));
          
               task.setVariable('ncwf_claimRejectedCause',  execution.getVariable('ncwf_claimRejectedCause'));
               task.setVariable('ncwf_claimRejectedState', 'none');</activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
          <activiti:field name="script">
            <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
						
             if(task.getVariable('ncwf_claimRejectedState') == 'none'){
	              task.setVariable('qa_claimClosingDate', new  java.util.Date());
	              task.setVariable('ncwf_ncState','closed');
	              execution.setVariable('ncwf_claimRejectedCause',  '');
	              
	                  if (bcpgwf_notifyUsers != null)  {
					          for (var i = 0; i &lt; bcpgwf_notifyUsers.size(); i++){
										sendMail(bcpgwf_notifyUsers.get(i),initiator,
										  bcpg.getMessage('claimProcess.mail.notify.closing.end.subject',bpm_workflowDescription),
										  bcpg.getMessage('claimProcess.mail.notify.closing.end.message'));  
									}	
				          	}
				           if(bcpgwf_notifyMe){
				               sendMail(initiator,initiator,
										  bcpg.getMessage('claimProcess.mail.notify.closing.end.subject',bpm_workflowDescription),
										  bcpg.getMessage('claimProcess.mail.notify.closing.end.message'));
							  }
	              
	            } else {
	              task.setVariable('ncwf_ncState',task.getVariable('ncwf_claimRejectedState'));
	              execution.setVariable('ncwf_claimRejectedCause',  task.getVariable('ncwf_claimRejectedCause'));
	            }
	            
	            
	            execution.setVariable('bcpgwf_notifyAssignee', task.getVariable('bcpgwf_notifyAssignee'));
        			execution.setVariable('bcpgwf_notifyUsers', task.getVariable('bcpgwf_notifyUsers'));
        			
               execution.setVariable('ncwf_claimRejectedState',  task.getVariable('ncwf_claimRejectedState'));</activiti:string>
          </activiti:field>
        </activiti:taskListener>
        <activiti:taskListener event="complete" class="fr.becpg.repo.workflow.activiti.nc.UpdateNC"></activiti:taskListener>
      </extensionElements>
    </userTask>
    <sequenceFlow id="backToAnalysisFlow1" name="Refus ou demande complémentaire" sourceRef="boundaryerror1" targetRef="analysisTask">
      <extensionElements>
        <activiti:executionListener event="take" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
          <activiti:field name="script">
            <activiti:string>logger.info("Go to analysis");</activiti:string>
          </activiti:field>
        </activiti:executionListener>
      </extensionElements>
    </sequenceFlow>
    <sequenceFlow id="toAnalysisFlow2" sourceRef="enteringClaimTask" targetRef="analysisTask"></sequenceFlow>
    <exclusiveGateway id="endOrientationGateway" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="toEndOrientationGateway" sourceRef="analysisTask" targetRef="endOrientationGateway"></sequenceFlow>
    <sequenceFlow id="backToEnteringClaimFlow" name="Refus ou demande complémentaire" sourceRef="endOrientationGateway" targetRef="enteringClaimTask">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimRejectedState == 'entry'}]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="validateClosingGateway" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="toValidateClosingGateway" sourceRef="claimClosingTask" targetRef="validateClosingGateway"></sequenceFlow>
    <sequenceFlow id="backToTreatementFlow1" name="Refus ou demande complémentaire" sourceRef="validateClosingGateway" targetRef="endOrientationGateway">
      <extensionElements>
        <activiti:executionListener event="take" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
          <activiti:field name="script">
            <activiti:string>logger.info("Go to analysis");</activiti:string>
          </activiti:field>
        </activiti:executionListener>
      </extensionElements>
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimRejectedState != 'none' }]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="toEndFlow" sourceRef="validateClosingGateway" targetRef="endevent1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimRejectedState == 'none' }]]></conditionExpression>
    </sequenceFlow>
    <endEvent id="endevent1" name="End"></endEvent>
    <sequenceFlow id="flow65" sourceRef="endOrientationGateway" targetRef="analysisTask">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ ncwf_claimRejectedState == 'analysis'  ||   (ncwf_claimRejectedState == 'treatment'  &&  qa_claimTreatmentActor==null ) || (ncwf_claimRejectedState == 'response' && qa_claimTreatmentActor==null  && qa_claimResponseActor==null) }]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="testDraftGateway" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="toTestIsDraft" sourceRef="initialiseNCTask" targetRef="testDraftGateway"></sequenceFlow>
    <sequenceFlow id="isDraftFlow" sourceRef="testDraftGateway" targetRef="enteringClaimTask">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimStartAsDraft == true}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="isNotDraftFlow" sourceRef="testDraftGateway" targetRef="analysisTask">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimStartAsDraft == false}]]></conditionExpression>
    </sequenceFlow>
    <subProcess id="subprocess1" name="Traitement réclammation">
      <userTask id="classificationTask" name="Classification" activiti:candidateGroups="GROUP_ClaimClassification" activiti:formKey="ncwf:claimClassificationTask">
        <extensionElements>
          <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
            <activiti:field name="script">
              <activiti:string>if (typeof bpm_workflowDueDate != 'undefined') task.dueDate = bpm_workflowDueDate;
              if (typeof bpm_workflowPriority != 'undefined') task.priority = bpm_workflowPriority;
					
					task.setVariable('bpm_comment', '');

					task.setVariable('ncwf_ncState','classification');</activiti:string>
            </activiti:field>
          </activiti:taskListener>
          <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
            <activiti:field name="script">
              <activiti:string>execution.setVariable('qa_claimType', task.getVariable('qa_claimType'));
            			execution.setVariable('qa_claimOriginHierarchy1', task.getVariable('qa_claimOriginHierarchy1'));
        		  	      execution.setVariable('qa_claimOriginHierarchy2', task.getVariable('qa_claimOriginHierarchy2'));
            			
		              execution.setVariable('bcpgwf_notifyAssignee', task.getVariable('bcpgwf_notifyAssignee'));
        		  	     execution.setVariable('bcpgwf_notifyUsers', task.getVariable('bcpgwf_notifyUsers'));
        		  	     if(execution.getVariable('ncwf_claimRejectedState') == 'classification'){
        		  	     	execution.setVariable('ncwf_claimRejectedState', 'none');
        		  	     }
        		  	     execution.setVariable('skipClassification',true);
        		  	     </activiti:string>
            </activiti:field>
          </activiti:taskListener>
          <activiti:taskListener event="complete" class="fr.becpg.repo.workflow.activiti.nc.UpdateNC"></activiti:taskListener>
        </extensionElements>
      </userTask>
      <sequenceFlow id="endClassificationFlow" name="OK" sourceRef="classificationTask" targetRef="jointTreatmentGateway"></sequenceFlow>
      <inclusiveGateway id="dispatchTreatmentGateway" name="Inclusive Gateway"></inclusiveGateway>
      <sequenceFlow id="toTreatmentFlow" name="Si acteur traitement" sourceRef="dispatchTreatmentGateway" targetRef="claimTreatmentTask">
        <extensionElements>
          <activiti:executionListener event="take" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
            <activiti:field name="script">
              <activiti:string>logger.info("Go To traitement "+qa_claimTreatmentActor);</activiti:string>
            </activiti:field>
          </activiti:executionListener>
        </extensionElements>
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${qa_claimTreatmentActor!=null && ncwf_claimRejectedState !='classification' && ncwf_claimRejectedState !='response'  }]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="toClassificationFlow" name="Dans tous les cas" sourceRef="dispatchTreatmentGateway" targetRef="classificationTask">
      	<conditionExpression xsi:type="tFormalExpression"><![CDATA[${skipClassification == false || ncwf_claimRejectedState =='classification'   }]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="toResponseWithoutTraitementFlow" name="Si acteur réponse et pas d'acteur traitement" sourceRef="dispatchTreatmentGateway" targetRef="claimResponseTask">
        <extensionElements>
          <activiti:executionListener event="take" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
            <activiti:field name="script">
              <activiti:string>logger.info("Go To response"+qa_claimResponseActor);</activiti:string>
            </activiti:field>
          </activiti:executionListener>
        </extensionElements>
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(qa_claimTreatmentActor == null &&  qa_claimResponseActor!=null && ncwf_claimRejectedState =='none') 
      ||  (  qa_claimResponseActor!=null && ncwf_claimRejectedState =='response')}]]></conditionExpression>
      </sequenceFlow>
      <userTask id="claimTreatmentTask" name="Traitement" activiti:assignee="${qa_claimTreatmentActor.properties.userName}" activiti:formKey="ncwf:claimTreatmentTask">
        <extensionElements>
          <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
            <activiti:field name="script">
              <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
            if (typeof ncwf_claimTreatmentDueDate != 'undefined') task.dueDate = ncwf_claimTreatmentDueDate;
            if (typeof bpm_workflowPriority != 'undefined') task.priority = bpm_workflowPriority;
					
					task.setVariable('bpm_comment', '');

               task.setVariable('ncwf_claimRejectedCause',  execution.getVariable('ncwf_claimRejectedCause'));
            	task.setVariable('ncwf_claimRejectedState', 'none');
            	
            	if (bcpgwf_notifyAssignee) {
						sendMail(qa_claimTreatmentActor,initiator,  
								 bcpg.getMessage('claimProcess.mail.action.treatment.subject',bpm_workflowDescription),
								 bcpg.getMessage('claimProcess.mail.action.treatment.message'),
								 true);	
		          }</activiti:string>
            </activiti:field>
          </activiti:taskListener>
          <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
            <activiti:field name="script">
              <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
              
               task.setVariable('ncwf_ncState',task.getVariable('ncwf_claimRejectedState'));
            
	            if(task.getVariable('ncwf_claimRejectedState') == 'none'){
	              task.setVariable('qa_claimTreatmentDate', new  java.util.Date());
	              if(execution.getVariable('qa_claimResponseActor')!=null){
	               task.setVariable('ncwf_ncState','response');
	              } else {
	               task.setVariable('ncwf_ncState','closing');
	              }
	               execution.setVariable('ncwf_claimRejectedCause',  '');
	               
	              if (bcpgwf_notifyUsers != null)  {
			          for (var i = 0; i &lt; bcpgwf_notifyUsers.size(); i++){
							 sendMail(bcpgwf_notifyUsers.get(i),initiator,  
		             		 bcpg.getMessage('claimProcess.mail.notify.treatment.end.subject',bpm_workflowDescription),
								 bcpg.getMessage('claimProcess.mail.notify.treatment.end.message')
								); 
						}
		          }
		          
		          if(bcpgwf_notifyMe){
		               sendMail(initiator,initiator, 
		                   bcpg.getMessage('claimProcess.mail.notify.treatment.end.subject',bpm_workflowDescription),
								 bcpg.getMessage('claimProcess.mail.notify.treatment.end.message')); 
					  }
	               
               } else {
                 execution.setVariable('ncwf_claimRejectedCause',  task.getVariable('ncwf_claimRejectedCause'));
               }
              
          	  execution.setVariable('ncwf_claimRejectedState',  task.getVariable('ncwf_claimRejectedState'));
          	  execution.setVariable('qa_claimTreatementDetails', task.getVariable('qa_claimTreatementDetails'));
        
        			execution.setVariable('bcpgwf_notifyAssignee', task.getVariable('bcpgwf_notifyAssignee'));
        			execution.setVariable('bcpgwf_notifyUsers', task.getVariable('bcpgwf_notifyUsers'));</activiti:string>
            </activiti:field>
          </activiti:taskListener>
          <activiti:taskListener event="complete" class="fr.becpg.repo.workflow.activiti.nc.UpdateNC"></activiti:taskListener>
        </extensionElements>
      </userTask>
      <sequenceFlow id="toValidateTreatement1" sourceRef="claimTreatmentTask" targetRef="validateTreatementGateway"></sequenceFlow>
      <exclusiveGateway id="validateResponseGateway" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="toValidateTreatement2" sourceRef="validateResponseGateway" targetRef="validateTreatementGateway">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ ncwf_claimRejectedState != 'none' }]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow63" name="OK" sourceRef="validateResponseGateway" targetRef="jointTreatmentGateway">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimRejectedState == 'none' }]]></conditionExpression>
      </sequenceFlow>
      <userTask id="claimResponseTask" name="Réponse" activiti:assignee="${qa_claimResponseActor.properties.userName}" activiti:formKey="ncwf:claimResponseTask">
        <extensionElements>
          <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
            <activiti:field name="script">
              <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
            if (typeof ncwf_claimResponseDueDate != 'undefined') task.dueDate = ncwf_claimResponseDueDate;
            if (typeof bpm_workflowPriority != 'undefined') task.priority = bpm_workflowPriority;
					
					task.setVariable('bpm_comment', '');
					
               task.setVariable('ncwf_claimRejectedCause',  execution.getVariable('ncwf_claimRejectedCause'));
               task.setVariable('ncwf_claimRejectedState', 'none');
              
               task.setVariable('qa_claimTreatementDetails', execution.getVariable('qa_claimTreatementDetails'));
            	
            	if (bcpgwf_notifyAssignee) {
						sendMail(qa_claimResponseActor,initiator, 
						       bcpg.getMessage('claimProcess.mail.action.response.subject',bpm_workflowDescription),
								 bcpg.getMessage('claimProcess.mail.action.response.message'),
								 true);  
		          }</activiti:string>
            </activiti:field>
          </activiti:taskListener>
          <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
            <activiti:field name="script">
              <activiti:string>&lt;import resource="classpath:alfresco/module/${pom.artifactId}/workflow/quality/claim-process.js"&gt;
						
            	if(task.getVariable('ncwf_claimRejectedState') == 'none'){
	              task.setVariable('qa_claimResponseDate', new  java.util.Date());
	              task.setVariable('ncwf_ncState','closing');
	              execution.setVariable('ncwf_claimRejectedCause',  '');
	                
	                
			              if (bcpgwf_notifyUsers != null)  {
					          for (var i = 0; i &lt; bcpgwf_notifyUsers.size(); i++){
										sendMail(bcpgwf_notifyUsers.get(i),initiator,
										  bcpg.getMessage('claimProcess.mail.notify.response.end.subject',bpm_workflowDescription),
										  bcpg.getMessage('claimProcess.mail.notify.response.end.message'));  
									}	
				          	}
				           if(bcpgwf_notifyMe){
				               sendMail(initiator,initiator,
										  bcpg.getMessage('claimProcess.mail.notify.response.end.subject',bpm_workflowDescription),
										  bcpg.getMessage('claimProcess.mail.notify.response.end.message'));
							  }
	             
	            } else {
	               task.setVariable('ncwf_ncState',task.getVariable('ncwf_claimRejectedState'));
	               execution.setVariable('ncwf_claimRejectedCause',  task.getVariable('ncwf_claimRejectedCause'));
	            }
	            
	            execution.setVariable('bcpgwf_notifyAssignee', task.getVariable('bcpgwf_notifyAssignee'));
        			execution.setVariable('bcpgwf_notifyUsers', task.getVariable('bcpgwf_notifyUsers'));
        			
	            execution.setVariable('ncwf_claimRejectedState',  task.getVariable('ncwf_claimRejectedState'));
           		execution.setVariable('qa_claimResponseState', task.getVariable('qa_claimResponseState'));
			      execution.setVariable('qa_claimResponseDetails', task.getVariable('qa_claimResponseDetails'));</activiti:string>
            </activiti:field>
          </activiti:taskListener>
          <activiti:taskListener event="complete" class="fr.becpg.repo.workflow.activiti.nc.UpdateNC"></activiti:taskListener>
        </extensionElements>
      </userTask>
      <sequenceFlow id="toValidateResponse" sourceRef="claimResponseTask" targetRef="validateResponseGateway"></sequenceFlow>
      <inclusiveGateway id="jointTreatmentGateway" name="Inclusive Gateway"></inclusiveGateway>
      <endEvent id="endevent2" name="End"></endEvent>
      <sequenceFlow id="flow66" sourceRef="jointTreatmentGateway" targetRef="endevent2"></sequenceFlow>
      <startEvent id="startevent1" name="Start"></startEvent>
      <sequenceFlow id="flow67" sourceRef="startevent1" targetRef="dispatchTreatmentGateway"></sequenceFlow>
      <endEvent id="errorendevent1" name="ErrorEnd">
        <errorEventDefinition errorRef="errorRejected"></errorEventDefinition>
      </endEvent>
      <exclusiveGateway id="validateTreatementGateway" name="Exclusive Gateway"></exclusiveGateway>
      <sequenceFlow id="toResponseFlow" name="Si acteur réponse ou refus" sourceRef="validateTreatementGateway" targetRef="claimResponseTask">
        <extensionElements>
          <activiti:executionListener event="take" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
            <activiti:field name="script">
              <activiti:string>logger.info("Go To response"+qa_claimResponseActor);</activiti:string>
            </activiti:field>
          </activiti:executionListener>
        </extensionElements>
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${qa_claimResponseActor!=null && !(  ncwf_claimRejectedState == 'treatment'  ||   ncwf_claimRejectedState == 'analysis')}]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="backToTraitementFlow3" name="Refus ou demande complémentaire" sourceRef="validateTreatementGateway" targetRef="claimTreatmentTask">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(ncwf_claimRejectedState == 'treatment' && qa_claimTreatmentActor!=null)
  || (ncwf_claimRejectedState == 'response' && qa_claimResponseActor==null) }]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="endTreatmentFlow" name="OK" sourceRef="validateTreatementGateway" targetRef="jointTreatmentGateway">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ncwf_claimRejectedState == 'none' }]]></conditionExpression>
      </sequenceFlow>
      <sequenceFlow id="flow68" sourceRef="validateTreatementGateway" targetRef="errorendevent1">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${ ncwf_claimRejectedState == 'analysis'  ||   (ncwf_claimRejectedState == 'treatment'  &&  qa_claimTreatmentActor==null )
 || (ncwf_claimRejectedState == 'response' && qa_claimTreatmentActor==null  && qa_claimResponseActor==null) }]]></conditionExpression>
      </sequenceFlow>
    </subProcess>
    <sequenceFlow id="flow64" sourceRef="subprocess1" targetRef="claimClosingTask"></sequenceFlow>
    <boundaryEvent id="boundaryerror1" name="Error" attachedToRef="subprocess1">
      <errorEventDefinition errorRef="errorRejected"></errorEventDefinition>
    </boundaryEvent>
    <textAnnotation id="textannotation1">
      <text>Assigné au groupe Orientation réclamation </text>
    </textAnnotation>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_claimProcess">
    <bpmndi:BPMNPlane bpmnElement="claimProcess" id="BPMNPlane_claimProcess">
      <bpmndi:BPMNShape bpmnElement="analysisTask" id="BPMNShape_analysisTask">
        <omgdc:Bounds height="55.0" width="105.0" x="186.0" y="319.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="claimClosingTask" id="BPMNShape_claimClosingTask">
        <omgdc:Bounds height="55.0" width="105.0" x="978.0" y="222.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="1100.0" y="333.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="initialiseNCTask" id="BPMNShape_initialiseNCTask">
        <omgdc:Bounds height="55.0" width="105.0" x="-77.0" y="319.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startClaimProcess" id="BPMNShape_startClaimProcess">
        <omgdc:Bounds height="35.0" width="35.0" x="-160.0" y="329.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="claimTreatmentTask" id="BPMNShape_claimTreatmentTask">
        <omgdc:Bounds height="55.0" width="105.0" x="510.0" y="148.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="classificationTask" id="BPMNShape_classificationTask">
        <omgdc:Bounds height="55.0" width="105.0" x="648.0" y="354.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="claimResponseTask" id="BPMNShape_claimResponseTask">
        <omgdc:Bounds height="55.0" width="105.0" x="778.0" y="70.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="textannotation1" id="BPMNShape_textannotation1">
        <omgdc:Bounds height="50.0" width="100.0" x="131.0" y="252.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateTreatementGateway" id="BPMNShape_validateTreatementGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="680.0" y="230.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="enteringClaimTask" id="BPMNShape_enteringClaimTask">
        <omgdc:Bounds height="55.0" width="105.0" x="50.0" y="414.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endOrientationGateway" id="BPMNShape_endOrientationGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="310.0" y="326.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="dispatchTreatmentGateway" id="BPMNShape_dispatchTreatmentGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="450.0" y="238.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="jointTreatmentGateway" id="BPMNShape_jointTreatmentGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="810.0" y="230.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateClosingGateway" id="BPMNShape_validateClosingGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="1010.0" y="330.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="validateResponseGateway" id="BPMNShape_validateResponseGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="810.0" y="155.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="testDraftGateway" id="BPMNShape_testDraftGateway">
        <omgdc:Bounds height="40.0" width="40.0" x="83.0" y="326.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="subprocess1" id="BPMNShape_subprocess1" isExpanded="false">
        <omgdc:Bounds height="431.0" width="533.0" x="390.0" y="38.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent2" id="BPMNShape_endevent2">
        <omgdc:Bounds height="35.0" width="35.0" x="870.0" y="233.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="400.0" y="241.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="errorendevent1" id="BPMNShape_errorendevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="770.0" y="320.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="boundaryerror1" id="BPMNShape_boundaryerror1">
        <omgdc:Bounds height="30.0" width="30.0" x="910.0" y="48.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="toDispatchTreatmentGateway" id="BPMNEdge_toDispatchTreatmentGateway">
        <omgdi:waypoint x="350.0" y="346.0"></omgdi:waypoint>
        <omgdi:waypoint x="389.0" y="346.0"></omgdi:waypoint>
        <omgdi:waypoint x="390.0" y="253.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toValidateClosingGateway" id="BPMNEdge_toValidateClosingGateway">
        <omgdi:waypoint x="1030.0" y="277.0"></omgdi:waypoint>
        <omgdi:waypoint x="1030.0" y="330.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toResponseWithoutTraitementFlow" id="BPMNEdge_toResponseWithoutTraitementFlow">
        <omgdi:waypoint x="470.0" y="238.0"></omgdi:waypoint>
        <omgdi:waypoint x="469.0" y="97.0"></omgdi:waypoint>
        <omgdi:waypoint x="778.0" y="97.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="52.0" width="100.0" x="-40.0" y="-17.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="startFlow" id="BPMNEdge_startFlow">
        <omgdi:waypoint x="-125.0" y="346.0"></omgdi:waypoint>
        <omgdi:waypoint x="-77.0" y="346.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toTreatmentFlow" id="BPMNEdge_toTreatmentFlow">
        <omgdi:waypoint x="470.0" y="238.0"></omgdi:waypoint>
        <omgdi:waypoint x="469.0" y="174.0"></omgdi:waypoint>
        <omgdi:waypoint x="510.0" y="175.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="13.0" width="93.0" x="-49.0" y="22.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toClassificationFlow" id="BPMNEdge_toClassificationFlow">
        <omgdi:waypoint x="470.0" y="278.0"></omgdi:waypoint>
        <omgdi:waypoint x="469.0" y="381.0"></omgdi:waypoint>
        <omgdi:waypoint x="648.0" y="381.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="13.0" width="83.0" x="-59.0" y="-39.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toResponseFlow" id="BPMNEdge_toResponseFlow">
        <omgdi:waypoint x="700.0" y="230.0"></omgdi:waypoint>
        <omgdi:waypoint x="700.0" y="135.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="125.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="39.0" width="100.0" x="-44.0" y="-11.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toEndFlow" id="BPMNEdge_toEndFlow">
        <omgdi:waypoint x="1050.0" y="350.0"></omgdi:waypoint>
        <omgdi:waypoint x="1100.0" y="350.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toValidateTreatement1" id="BPMNEdge_toValidateTreatement1">
        <omgdi:waypoint x="562.0" y="203.0"></omgdi:waypoint>
        <omgdi:waypoint x="639.0" y="218.0"></omgdi:waypoint>
        <omgdi:waypoint x="700.0" y="230.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toValidateTreatement2" id="BPMNEdge_toValidateTreatement2">
        <omgdi:waypoint x="830.0" y="195.0"></omgdi:waypoint>
        <omgdi:waypoint x="700.0" y="230.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="backToAnalysisFlow1" id="BPMNEdge_backToAnalysisFlow1">
        <omgdi:waypoint x="940.0" y="63.0"></omgdi:waypoint>
        <omgdi:waypoint x="995.0" y="62.0"></omgdi:waypoint>
        <omgdi:waypoint x="995.0" y="-1.0"></omgdi:waypoint>
        <omgdi:waypoint x="598.0" y="-1.0"></omgdi:waypoint>
        <omgdi:waypoint x="238.0" y="-1.0"></omgdi:waypoint>
        <omgdi:waypoint x="238.0" y="319.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="39.0" width="100.0" x="58.0" y="-45.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="backToTreatementFlow1" id="BPMNEdge_backToTreatementFlow1">
        <omgdi:waypoint x="1030.0" y="370.0"></omgdi:waypoint>
        <omgdi:waypoint x="1030.0" y="488.0"></omgdi:waypoint>
        <omgdi:waypoint x="330.0" y="488.0"></omgdi:waypoint>
        <omgdi:waypoint x="330.0" y="366.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="39.0" width="100.0" x="-53.0" y="22.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="backToTraitementFlow3" id="BPMNEdge_backToTraitementFlow3">
        <omgdi:waypoint x="720.0" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="692.0" y="244.0"></omgdi:waypoint>
        <omgdi:waypoint x="562.0" y="244.0"></omgdi:waypoint>
        <omgdi:waypoint x="562.0" y="203.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="39.0" width="100.0" x="-52.0" y="8.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toAnalysisFlow2" id="BPMNEdge_toAnalysisFlow2">
        <omgdi:waypoint x="102.0" y="414.0"></omgdi:waypoint>
        <omgdi:waypoint x="238.0" y="374.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="endTreatmentFlow" id="BPMNEdge_endTreatmentFlow">
        <omgdi:waypoint x="720.0" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="810.0" y="250.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="13.0" width="15.0" x="10.0" y="0.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow63" id="BPMNEdge_flow63">
        <omgdi:waypoint x="830.0" y="195.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="230.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="13.0" width="15.0" x="10.0" y="0.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toValidateResponse" id="BPMNEdge_toValidateResponse">
        <omgdi:waypoint x="830.0" y="125.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="155.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="endClassificationFlow" id="BPMNEdge_endClassificationFlow">
        <omgdi:waypoint x="753.0" y="381.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="382.0"></omgdi:waypoint>
        <omgdi:waypoint x="830.0" y="270.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="13.0" width="15.0" x="10.0" y="0.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toEndOrientationGateway" id="BPMNEdge_toEndOrientationGateway">
        <omgdi:waypoint x="291.0" y="346.0"></omgdi:waypoint>
        <omgdi:waypoint x="310.0" y="346.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="backToEnteringClaimFlow" id="BPMNEdge_backToEnteringClaimFlow">
        <omgdi:waypoint x="330.0" y="366.0"></omgdi:waypoint>
        <omgdi:waypoint x="330.0" y="492.0"></omgdi:waypoint>
        <omgdi:waypoint x="102.0" y="492.0"></omgdi:waypoint>
        <omgdi:waypoint x="102.0" y="469.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="39.0" width="100.0" x="-86.0" y="-2.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow64" id="BPMNEdge_flow64">
        <omgdi:waypoint x="923.0" y="253.0"></omgdi:waypoint>
        <omgdi:waypoint x="978.0" y="249.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow65" id="BPMNEdge_flow65">
        <omgdi:waypoint x="330.0" y="326.0"></omgdi:waypoint>
        <omgdi:waypoint x="330.0" y="222.0"></omgdi:waypoint>
        <omgdi:waypoint x="238.0" y="222.0"></omgdi:waypoint>
        <omgdi:waypoint x="238.0" y="319.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="toTestIsDraft" id="BPMNEdge_toTestIsDraft">
        <omgdi:waypoint x="28.0" y="346.0"></omgdi:waypoint>
        <omgdi:waypoint x="83.0" y="346.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="isDraftFlow" id="BPMNEdge_isDraftFlow">
        <omgdi:waypoint x="103.0" y="366.0"></omgdi:waypoint>
        <omgdi:waypoint x="102.0" y="414.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="isNotDraftFlow" id="BPMNEdge_isNotDraftFlow">
        <omgdi:waypoint x="123.0" y="346.0"></omgdi:waypoint>
        <omgdi:waypoint x="186.0" y="346.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow66" id="BPMNEdge_flow66">
        <omgdi:waypoint x="850.0" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="870.0" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow67" id="BPMNEdge_flow67">
        <omgdi:waypoint x="435.0" y="258.0"></omgdi:waypoint>
        <omgdi:waypoint x="450.0" y="258.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow68" id="BPMNEdge_flow68">
        <omgdi:waypoint x="700.0" y="270.0"></omgdi:waypoint>
        <omgdi:waypoint x="787.0" y="320.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>